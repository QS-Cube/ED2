(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     82538,       2119]
NotebookOptionsPosition[     77545,       2033]
NotebookOutlinePosition[     78156,       2054]
CellTagsIndexPosition[     78113,       2051]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sz", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"Table", "[", 
      RowBox[{"ii", ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "SS", ",", 
         RowBox[{"-", "SS"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sp", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"SS", 
          RowBox[{"(", 
           RowBox[{"SS", "+", "1"}], ")"}]}], "-", 
         RowBox[{"jj", 
          RowBox[{"(", 
           RowBox[{"jj", "+", "1"}], ")"}]}]}]], 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"ii", ",", 
         RowBox[{"jj", "+", "1"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "SS", ",", 
        RowBox[{"-", "SS"}], ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "SS", ",", 
        RowBox[{"-", "SS"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sx", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"Sp", "+", 
      RowBox[{"Sp", "\[Transpose]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sy", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", "\[ImaginaryI]"}]], 
    RowBox[{"(", 
     RowBox[{"Sp", "-", 
      RowBox[{"Sp", "\[Transpose]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"II", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{
      RowBox[{"2", "SS"}], "+", "1"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8590126932424097`*^9, 3.8590128932112803`*^9}, {
   3.8590147128192883`*^9, 3.859014724028838*^9}, {3.8590147981878066`*^9, 
   3.8590148088017583`*^9}, {3.8590149071904373`*^9, 
   3.8590149074067397`*^9}, {3.8608462988447695`*^9, 3.8608463077173653`*^9}, 
   3.860846441572929*^9, {3.860847318732803*^9, 3.8608473279598017`*^9}, {
   3.8608473956579404`*^9, 3.8608474079702573`*^9}, {3.8716778381239443`*^9, 
   3.871677850384023*^9}, {3.895544404055787*^9, 3.8955444090858555`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d1f9668e-5699-4eab-b05b-3a893d4f2097"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NS", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NOD", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SzMin", "=", 
    RowBox[{
     RowBox[{"NS", "*", "SS"}], "-", "NOD"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "plays", " ", "the", " ", "role", " ", "of", " ", "Sztot", " ", "when", 
    " ", "U", 
    RowBox[{"(", "1", ")"}], " ", "is", " ", "preserved"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.835748605111039*^9, {3.835748639232997*^9, 3.8357486466808863`*^9}, {
   3.846896778081738*^9, 3.8468967783292828`*^9}, {3.84690270158916*^9, 
   3.846902702122139*^9}, {3.8469027553996983`*^9, 3.8469027561551237`*^9}, {
   3.852533300621213*^9, 3.852533300757848*^9}, {3.8525359328591137`*^9, 
   3.8525359329527493`*^9}, 3.858827546065132*^9, {3.859011740655818*^9, 
   3.8590117715174522`*^9}, 3.8590118420963106`*^9, {3.8590148170312967`*^9, 
   3.859014866696488*^9}, {3.8650535165518136`*^9, 3.865053527019821*^9}, {
   3.872919072138908*^9, 3.872919082435092*^9}, {3.872919555982209*^9, 
   3.8729195870280137`*^9}, {3.894337669350979*^9, 3.89433767150371*^9}, {
   3.8955444126009626`*^9, 3.8955444166584373`*^9}, 3.8955450309256983`*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"eefab55a-d9f5-41d4-8c6b-d3c74d69dea7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"mSx", "[", "nn", "]"}], "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "NS"}], "}"}]}], "]"}], ",", 
           RowBox[{"nn", "\[Rule]", "Sx"}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mSy", "[", "nn", "]"}], "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "NS"}], "}"}]}], "]"}], ",", 
           RowBox[{"nn", "\[Rule]", "Sy"}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mSp", "[", "nn", "]"}], "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "NS"}], "}"}]}], "]"}], ",", 
           RowBox[{"nn", "\[Rule]", "Sp"}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mSm", "[", "nn", "]"}], "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "NS"}], "}"}]}], "]"}], ",", 
           RowBox[{"nn", "\[Rule]", 
            RowBox[{"Sp", "\[Transpose]"}]}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mSz", "[", "nn", "]"}], "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "NS"}], "}"}]}], "]"}], ",", 
           RowBox[{"nn", "\[Rule]", "Sz"}]}], "]"}]}], "]"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"nn", ",", "1", ",", "NS", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.835748649302706*^9, 3.835748650532366*^9}, {
   3.84690209825313*^9, 3.846902099565158*^9}, {3.846904128746945*^9, 
   3.846904142986796*^9}, 3.85253511842143*^9, {3.8590118551704464`*^9, 
   3.8590118661995497`*^9}, {3.896838828581442*^9, 3.896838843718651*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"695e3440-164c-4828-854a-67815aef1456"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Jbonds", "=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "2", ",", "3", ",", "3", ",", "4", ",", "4", ",", 
      "5", ",", "5", ",", "6", ",", "6", ",", "1"}], "}"}], ",", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Dbonds", "=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "2", ",", "3", ",", "3", ",", "4", ",", "4", ",", 
      "5", ",", "5", ",", "6", ",", "6", ",", "1"}], "}"}], ",", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Gbonds", "=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "2", ",", "3", ",", "3", ",", "4", ",", "4", ",", 
      "5", ",", "5", ",", "6", ",", "6", ",", "1"}], "}"}], ",", "2"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQbbO7Tk1myhtHtYv31UF0z1PBGBB948OkVBCtevPv
5PiVbxzZMpxngGgea6HFIPqHusF2EP1JQiV77eY3jmY/b5WCaLmpNypBtNPZ
Ja0getXblhPyW944MhTX3wTRUnmZAopA+sQ9A2EQ3WDdKAGitY4zKoDo2Jmx
KooH3jiWvk1QBdEca/4qVwPpjPcuKiC65+zBuTVA+r1L/zwQfej2bm3GM28c
JWYn6IBonYOrWJluv3G8VHeKHUQvms1iD6ItFpiB6Y5vhcJ3mN86ZvAfA9Pv
bl5XBtGPN/8A05dXrfDVZHvrePNgjx+INjoZYjOZ963jsyc7wTQAUGOaUA==

  "],
 CellLabel->"In[11]:=",ExpressionUUID->"86e637fc-830a-4417-8768-18c80ed3f109"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.835749177213112*^9, 3.835751609937346*^9, 3.8360032225057573`*^9, 
   3.836005281024932*^9, 3.836008014496929*^9, 3.83600973694934*^9, 
   3.836011841702182*^9, 3.83601372087687*^9, 3.839593063242775*^9, 
   3.843165780684718*^9, 3.843182084320368*^9, 3.8437902686806107`*^9, 
   3.8437971291717987`*^9, 3.844211815954352*^9, 3.844230275774041*^9, 
   3.846896941973054*^9, {3.8468970561574163`*^9, 3.846897082925179*^9}, 
   3.8468974975199947`*^9, 3.8468977222678623`*^9, 3.846903734170856*^9, 
   3.847498809897109*^9, 3.848627119491132*^9, 3.8522991409096117`*^9, 
   3.8522991834402637`*^9, {3.852299284073073*^9, 3.852299313543104*^9}, 
   3.852303033106797*^9, 3.8523034015807333`*^9, 3.8525217210355773`*^9, 
   3.8525230941989717`*^9, 3.8525334787850513`*^9, 3.852536065740768*^9, 
   3.852537897177081*^9, 3.8525394890281763`*^9, 3.852539775238*^9, 
   3.8525399313468227`*^9, 3.8525404489747667`*^9, 3.853847015003517*^9, 
   3.856381825526411*^9, 3.8588275649866505`*^9, 3.859011930816147*^9, 
   3.859014910482568*^9, 3.859423136641081*^9, 3.8594231980213947`*^9, {
   3.8594233168689013`*^9, 3.859423351091732*^9}, 3.8594272714553223`*^9, 
   3.8642523935252695`*^9, 3.865053540478675*^9, 3.872919489993284*^9, 
   3.8729196154857426`*^9, {3.8729200403053093`*^9, 3.872920058880395*^9}, 
   3.894337696042715*^9, 3.8943378247847176`*^9, 3.8955444386798205`*^9, 
   3.8955450388388042`*^9, 3.895545229188249*^9, 3.8955470428599987`*^9, 
   3.896838852407874*^9, 3.899431452484977*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"8ad23f95-13b9-49b4-abda-067811b06aa2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.835749177213112*^9, 3.835751609937346*^9, 3.8360032225057573`*^9, 
   3.836005281024932*^9, 3.836008014496929*^9, 3.83600973694934*^9, 
   3.836011841702182*^9, 3.83601372087687*^9, 3.839593063242775*^9, 
   3.843165780684718*^9, 3.843182084320368*^9, 3.8437902686806107`*^9, 
   3.8437971291717987`*^9, 3.844211815954352*^9, 3.844230275774041*^9, 
   3.846896941973054*^9, {3.8468970561574163`*^9, 3.846897082925179*^9}, 
   3.8468974975199947`*^9, 3.8468977222678623`*^9, 3.846903734170856*^9, 
   3.847498809897109*^9, 3.848627119491132*^9, 3.8522991409096117`*^9, 
   3.8522991834402637`*^9, {3.852299284073073*^9, 3.852299313543104*^9}, 
   3.852303033106797*^9, 3.8523034015807333`*^9, 3.8525217210355773`*^9, 
   3.8525230941989717`*^9, 3.8525334787850513`*^9, 3.852536065740768*^9, 
   3.852537897177081*^9, 3.8525394890281763`*^9, 3.852539775238*^9, 
   3.8525399313468227`*^9, 3.8525404489747667`*^9, 3.853847015003517*^9, 
   3.856381825526411*^9, 3.8588275649866505`*^9, 3.859011930816147*^9, 
   3.859014910482568*^9, 3.859423136641081*^9, 3.8594231980213947`*^9, {
   3.8594233168689013`*^9, 3.859423351091732*^9}, 3.8594272714553223`*^9, 
   3.8642523935252695`*^9, 3.865053540478675*^9, 3.872919489993284*^9, 
   3.8729196154857426`*^9, {3.8729200403053093`*^9, 3.872920058880395*^9}, 
   3.894337696042715*^9, 3.8943378247847176`*^9, 3.8955444386798205`*^9, 
   3.8955450388388042`*^9, 3.895545229188249*^9, 3.8955470428599987`*^9, 
   3.896838852407874*^9, 3.8994314524879713`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"277940c9-549b-4c24-b118-6914ea920b39"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.835749177213112*^9, 3.835751609937346*^9, 3.8360032225057573`*^9, 
   3.836005281024932*^9, 3.836008014496929*^9, 3.83600973694934*^9, 
   3.836011841702182*^9, 3.83601372087687*^9, 3.839593063242775*^9, 
   3.843165780684718*^9, 3.843182084320368*^9, 3.8437902686806107`*^9, 
   3.8437971291717987`*^9, 3.844211815954352*^9, 3.844230275774041*^9, 
   3.846896941973054*^9, {3.8468970561574163`*^9, 3.846897082925179*^9}, 
   3.8468974975199947`*^9, 3.8468977222678623`*^9, 3.846903734170856*^9, 
   3.847498809897109*^9, 3.848627119491132*^9, 3.8522991409096117`*^9, 
   3.8522991834402637`*^9, {3.852299284073073*^9, 3.852299313543104*^9}, 
   3.852303033106797*^9, 3.8523034015807333`*^9, 3.8525217210355773`*^9, 
   3.8525230941989717`*^9, 3.8525334787850513`*^9, 3.852536065740768*^9, 
   3.852537897177081*^9, 3.8525394890281763`*^9, 3.852539775238*^9, 
   3.8525399313468227`*^9, 3.8525404489747667`*^9, 3.853847015003517*^9, 
   3.856381825526411*^9, 3.8588275649866505`*^9, 3.859011930816147*^9, 
   3.859014910482568*^9, 3.859423136641081*^9, 3.8594231980213947`*^9, {
   3.8594233168689013`*^9, 3.859423351091732*^9}, 3.8594272714553223`*^9, 
   3.8642523935252695`*^9, 3.865053540478675*^9, 3.872919489993284*^9, 
   3.8729196154857426`*^9, {3.8729200403053093`*^9, 3.872920058880395*^9}, 
   3.894337696042715*^9, 3.8943378247847176`*^9, 3.8955444386798205`*^9, 
   3.8955450388388042`*^9, 3.895545229188249*^9, 3.8955470428599987`*^9, 
   3.896838852407874*^9, 3.8994314524919605`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"8ff6f531-4e63-454f-b03a-9f60697157f2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hami", "[", 
    RowBox[{
    "Jx_", ",", "Jy_", ",", "Jz_", ",", "Dx_", ",", "Dy_", ",", "Dz_", ",", 
     "Gx_", ",", "Gy_", ",", "Gz_", ",", "Hx_", ",", "Hy_", ",", "Hz_"}], 
    "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"HAll", "=", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Jx", " ", 
             RowBox[{
              RowBox[{"mSx", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
              RowBox[{"mSx", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "+", 
            RowBox[{"Jy", " ", 
             RowBox[{
              RowBox[{"mSy", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
              RowBox[{"mSy", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], " ", "+", 
            RowBox[{"Jz", " ", 
             RowBox[{
              RowBox[{"mSz", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
              RowBox[{"mSz", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}], ")"}], "&"}], "/@",
          "Jbonds"}], "]"}], "+", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Dx", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}]}], "+", 
            RowBox[{"Dy", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}]}], " ", 
            "+", 
            RowBox[{"Dz", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}]}]}], ")"}],
           "&"}], "/@", "Dbonds"}], "]"}], "+", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Gx", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}]}], "+", 
            RowBox[{"Gy", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}]}], " ", 
            "+", 
            RowBox[{"Gz", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}]}]}], ")"}],
           "&"}], "/@", "Dbonds"}], "]"}], "-", 
       RowBox[{"Hx", " ", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mSx", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "NS", "]"}]}], "]"}]}], "-", 
       RowBox[{"Hy", " ", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mSy", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "NS", "]"}]}], "]"}]}], "-", 
       RowBox[{"Hz", " ", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mSz", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "NS", "]"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"When", " ", "U", 
       RowBox[{"(", "1", ")"}], " ", "is", " ", "preserved"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"posi", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Normal", "[", 
            RowBox[{"Diagonal", "[", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"mSz", "[", "#", "]"}], "&"}], "/@", 
               RowBox[{"Range", "[", "NS", "]"}]}], "]"}], "]"}], "]"}], ",", 
           
           RowBox[{"n_", " ", "/;", " ", 
            RowBox[{"n", "==", "SzMin"}]}]}], "]"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"When", " ", "U", 
       RowBox[{"(", "1", ")"}], " ", "is", " ", "not", " ", "preserved"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"posi", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"Diagonal", "[", 
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mSz", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", "NS", "]"}]}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"n_", " ", "/;", " ", 
          RowBox[{"n", ">=", "SzMin"}]}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"HAll", "[", 
      RowBox[{"[", 
       RowBox[{"posi", ",", "posi"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
    ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.835749236308423*^9, 3.835749259905862*^9}, {
   3.8357493015228033`*^9, 3.835749303802754*^9}, {3.835749354659789*^9, 
   3.835749380677432*^9}, 3.83575003357922*^9, {3.835750321347682*^9, 
   3.835750327923233*^9}, {3.8357505146508102`*^9, 3.835750522514373*^9}, 
   3.835750554553487*^9, {3.8357506131349487`*^9, 3.83575066032944*^9}, {
   3.8357508609895773`*^9, 3.8357509756212683`*^9}, {3.8357510104053793`*^9, 
   3.8357510731009073`*^9}, {3.83575111083736*^9, 3.835751236323717*^9}, {
   3.835751285236122*^9, 3.8357512853313627`*^9}, {3.8357513173800917`*^9, 
   3.835751343347898*^9}, {3.835751412843955*^9, 3.8357515505990763`*^9}, {
   3.835752087984779*^9, 3.8357520977107983`*^9}, 3.835752345270014*^9, {
   3.8357524113105173`*^9, 3.8357524128782167`*^9}, {3.835753832756716*^9, 
   3.8357538742880774`*^9}, {3.836004518178898*^9, 3.8360045491781807`*^9}, {
   3.836005912296547*^9, 3.836006039320539*^9}, {3.8360073943462963`*^9, 
   3.8360074596080837`*^9}, {3.836007573576137*^9, 3.836007655800295*^9}, {
   3.836007698641397*^9, 3.8360077426560297`*^9}, {3.836008185369494*^9, 
   3.836008201575471*^9}, {3.836010023935727*^9, 3.836010117668153*^9}, {
   3.836010583836747*^9, 3.836010587706355*^9}, 3.836010796443634*^9, {
   3.836010827497513*^9, 3.8360108562334337`*^9}, 3.83601090083339*^9, 
   3.8360118287432117`*^9, {3.836012643129567*^9, 3.8360126446043797`*^9}, 
   3.8360136601445093`*^9, {3.846897270947372*^9, 3.846897437409424*^9}, 
   3.846898298265911*^9, {3.8468986612065897`*^9, 3.846898679705593*^9}, {
   3.846902266696879*^9, 3.846902276328711*^9}, {3.846902306580574*^9, 
   3.846902315373189*^9}, 3.846902625885776*^9, {3.8469026558938828`*^9, 
   3.846902658847444*^9}, 3.846902693126952*^9, {3.846903141670808*^9, 
   3.846903243824995*^9}, {3.846903281778387*^9, 3.846903287119923*^9}, 
   3.8469038339750433`*^9, 3.846903888079928*^9, 3.846904017764452*^9, {
   3.846922820876429*^9, 3.8469228256335983`*^9}, {3.846923451552556*^9, 
   3.846923511041894*^9}, {3.846923556563575*^9, 3.84692357164128*^9}, {
   3.846924022930212*^9, 3.846924027593342*^9}, {3.8475025099343157`*^9, 
   3.847502527251458*^9}, {3.848627163557901*^9, 3.848627164147026*^9}, {
   3.852300810023588*^9, 3.852301006315295*^9}, {3.852301201619738*^9, 
   3.852301389073921*^9}, {3.8525335433227606`*^9, 3.852533873334607*^9}, {
   3.852533910943916*^9, 3.8525339439967775`*^9}, {3.8525361047666407`*^9, 
   3.8525361376579323`*^9}, {3.852536168029557*^9, 3.85253622041817*^9}, 
   3.852539764784671*^9, {3.8525408930113363`*^9, 3.85254091038559*^9}, {
   3.858827571779725*^9, 3.8588275774947457`*^9}, {3.858827622968748*^9, 
   3.858827693810526*^9}, {3.8590118848973217`*^9, 3.859012054359379*^9}, {
   3.8590149208349247`*^9, 3.8590149408004956`*^9}, {3.859014973728597*^9, 
   3.8590149986046*^9}, {3.859015186393597*^9, 3.8590152101988306`*^9}, {
   3.85901539062931*^9, 3.8590153963886814`*^9}, 3.8594274215746927`*^9, {
   3.864254178098172*^9, 3.8642541849106507`*^9}, {3.864254216026724*^9, 
   3.864254221263844*^9}, {3.864254775514139*^9, 3.8642547777497854`*^9}, {
   3.87291910138984*^9, 3.8729191626461115`*^9}, {3.895544447687689*^9, 
   3.8955444514722757`*^9}, {3.899431379345043*^9, 3.8994314097092085`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"468dd902-6354-44f1-b520-9401842ecba0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetMag", "[", 
   RowBox[{"vec_", ",", "posi_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"vec", "\[Conjugate]"}], ".", "#", ".", "vec"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"mSx", "[", "i", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"mSy", "[", "i", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"mSz", "[", "i", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"posi", ",", "posi"}], "]"}], "]"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.864252409376627*^9, 3.8642524957199636`*^9}, {
   3.8642526275276723`*^9, 3.864252638742082*^9}, {3.8642544224381*^9, 
   3.86425443232662*^9}, {3.8642544640307865`*^9, 3.864254465854549*^9}, 
   3.8642545779334373`*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"3806b937-f7f0-46ac-afb7-0adb4b6bfaa1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCorrXYZ", "[", 
   RowBox[{"vec_", ",", "posi_", ",", "i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vec", "\[Conjugate]"}], ".", "#", ".", "vec"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSx", "[", "i", "]"}], ".", 
          RowBox[{"mSx", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSx", "[", "i", "]"}], ".", 
          RowBox[{"mSy", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSx", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSy", "[", "i", "]"}], ".", 
          RowBox[{"mSx", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSy", "[", "i", "]"}], ".", 
          RowBox[{"mSy", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSy", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSx", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSy", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}]}], "}"}]}], ",", "3"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8955444986817694`*^9, 3.895544554822218*^9}, {
  3.8955447439604673`*^9, 3.895544780754654*^9}, {3.8955448284226255`*^9, 
  3.895544845008439*^9}, {3.8968388638951454`*^9, 3.896838864484391*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"55b2ec24-2297-4314-8f9a-234ed8abcf6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCorrPMZ", "[", 
   RowBox[{"vec_", ",", "posi_", ",", "i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vec", "\[Conjugate]"}], ".", "#", ".", "vec"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSp", "[", "i", "]"}], ".", 
          RowBox[{"mSp", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSp", "[", "i", "]"}], ".", 
          RowBox[{"mSm", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSp", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSm", "[", "i", "]"}], ".", 
          RowBox[{"mSp", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSm", "[", "i", "]"}], ".", 
          RowBox[{"mSm", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSm", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSp", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSm", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}]}], "}"}]}], ",", "3"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8968388118041677`*^9, 3.8968388207510448`*^9}, {
  3.896838860004522*^9, 3.896838887956397*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"69025ebf-6895-4ab0-bd8a-3745eace2945"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Entanglement", " ", "entropy", " ", "when", " ", "divided", " ", "into", 
     " ", "1"}], ",", "2", ",", "...", ",", 
    RowBox[{
     RowBox[{"l", " ", "and", " ", "l"}], "+", "1"}], ",", 
    RowBox[{"l", "+", "2"}], ",", ",", "...", ",", "NOS"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GetEE", "[", 
     RowBox[{"vec_", ",", "posi_", ",", "l_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Make", " ", "density", " ", "matrix"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rho", "=", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"vec", ",", 
          RowBox[{"vec", "\[Conjugate]"}]}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vec", "\[Conjugate]"}], ".", "vec"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Make", " ", "reduced", " ", "density", " ", "matrix", " ", "for", " ",
         "subsystem", " ", "A"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"listAB", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "l"}], "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"l", "+", "1"}], ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PadLeft", "[", 
            RowBox[{
             RowBox[{"IntegerDigits", "[", 
              RowBox[{
               RowBox[{"n", "-", "1"}], ",", 
               RowBox[{
                RowBox[{"2", "SS"}], "+", "1"}]}], "]"}], ",", "NS"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "SS"}], "+", "1"}], ")"}], "^", "NS"}]}], 
            "}"}]}], "]"}], "[", 
         RowBox[{"[", "posi", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"listA", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"listAB", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ruleA", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"listA", "->", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "listA", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"listB", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"listAB", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ruleB", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"listB", "->", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "listB", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"listABNum", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"listAB", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "/.", "ruleA"}], ",", 
          RowBox[{
           RowBox[{"listAB", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "/.", "ruleB"}]}], 
         "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rhoA", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"posiAi", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{"listABNum", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "_"}], "}"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"posiAj", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{"listABNum", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "_"}], "}"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"posiBi", "=", 
           RowBox[{"listABNum", "[", 
            RowBox[{"[", 
             RowBox[{"posiAi", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"posiBj", "=", 
           RowBox[{"listABNum", "[", 
            RowBox[{"[", 
             RowBox[{"posiAj", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"posiBi", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "==", 
               RowBox[{"posiBj", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], ",", 
              RowBox[{"rho", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"posiAi", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], ",", 
                 RowBox[{"posiAj", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "]"}], ",", "0"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", 
              RowBox[{"Length", "[", "posiAi", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"Length", "[", "posiAj", "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "listA", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "listA", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Calculate", " ", "vN", " ", "entropy", " ", "of", " ", "rhoA"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]val0", "=", 
       RowBox[{"Eigenvalues", "[", "rhoA", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]val", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"\[Lambda]val0", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", "#", "]"}], ">", 
           RowBox[{"10", "^", 
            RowBox[{"-", "12"}]}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SA", "=", 
       RowBox[{"-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Lambda]val", "[", 
            RowBox[{"[", "i", "]"}], "]"}], 
           RowBox[{"Log", "[", 
            RowBox[{"\[Lambda]val", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "\[Lambda]val", "]"}]}], "}"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "SA"}], "\[IndentingNewLine]",
      ")"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8729191972377768`*^9, 3.8729192767936335`*^9}, {
   3.872919320206108*^9, 3.872919345327308*^9}, {3.872919379117259*^9, 
   3.872919420690125*^9}, {3.8729194515639973`*^9, 3.872919479388748*^9}, {
   3.8729198377876964`*^9, 3.8729198462977285`*^9}, 3.8729198868614063`*^9, 
   3.872920249031021*^9, {3.872929330240371*^9, 3.87292935496992*^9}, {
   3.872931520318635*^9, 3.8729315360741777`*^9}, 3.8729324099110975`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"cbf716ff-aa25-4262-9080-7090d4d44064"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"hami", "[", 
    RowBox[{"(*", "Jx_", "*)"}], 
    RowBox[{"1.0", ",", 
     RowBox[{"(*", "Jy_", "*)"}], "1.0", ",", 
     RowBox[{"(*", "Jz_", "*)"}], "1.0", ",", 
     RowBox[{"(*", "Dx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Dy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Dz_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Gx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Gy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Gz_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hz_", "*)"}], "0."}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"mat", ",", "1", ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Arnoldi\>\"", ",", 
        RowBox[{"\"\<Shift\>\"", "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"Norm", "[", 
           RowBox[{"mat", ",", "2"}], "]"}]}]}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"val0", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"vec0", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "val0", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"GetMag", "[", 
           RowBox[{"vec0", ",", "posi", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NS"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx\>\"", ",", "\"\<Sy\>\"", ",", "\"\<Sz\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "NS"}], "}"}]}], "]"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetEE", "[", 
   RowBox[{"vec0", ",", "posi", ",", 
    RowBox[{"NS", "/", "2"}]}], "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8642525103765283`*^9, 3.864252604165722*^9}, {
  3.8642526447350073`*^9, 3.86425265969335*^9}, {3.864252947935561*^9, 
  3.8642529536547055`*^9}, {3.86425426295756*^9, 3.8642543297093*^9}, {
  3.872919635099105*^9, 3.87291966371762*^9}, {3.872920513802191*^9, 
  3.872920516133121*^9}, {3.8994314638769083`*^9, 3.8994314680348067`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"e41a7eed-97c1-419d-a9b4-f187d312d836"],

Cell[BoxData[
 RowBox[{"-", "2.8027756377319943`"}]], "Print",
 CellChangeTimes->{
  3.8642526054037848`*^9, {3.8642526486493535`*^9, 3.8642526603133144`*^9}, 
   3.864252954780164*^9, 3.864254265910923*^9, 3.864254299169235*^9, 
   3.8642543300235076`*^9, 3.8642547940206904`*^9, 3.8729202284944887`*^9, 
   3.872920325550832*^9, 3.872920583884041*^9, 3.8943377252789135`*^9, 
   3.8955447141281123`*^9, 3.895544784646886*^9, 3.89554504542165*^9, 
   3.896838897729766*^9, 3.8994314705115867`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[19]:=",ExpressionUUID->"e2ea2c1a-eb4c-41e4-b36c-\
79cea39c3cfe"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "2", "3", "4", "5", "6"},
     {"\<\"Sx\"\>", "0", "0", "0", "0", "0", "0"},
     {"\<\"Sy\"\>", "0", "0", "0", "0", "0", "0"},
     {"\<\"Sz\"\>", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.864252606529915*^9, {3.8642526486543407`*^9, 3.8642526603173027`*^9}, 
   3.864252954783156*^9, 3.864254265914912*^9, 3.864254299172228*^9, 
   3.8642543300284953`*^9, 3.8642547940236826`*^9, 3.872920228555212*^9, 
   3.8729203256008043`*^9, 3.872920583919051*^9, 3.894337725305843*^9, 
   3.8955447141454706`*^9, 3.8955447846488953`*^9, 3.8955450454236436`*^9, 
   3.8968388977555027`*^9, 3.89943147053457*^9},
 CellLabel->
  "Out[23]//MatrixForm=",ExpressionUUID->"44098b30-d700-44a0-ae54-\
64721484c37c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0157373`", ",", "0.9590063760890905`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.864252606529915*^9, {3.8642526486543407`*^9, 3.8642526603173027`*^9}, 
   3.864252954783156*^9, 3.864254265914912*^9, 3.864254299172228*^9, 
   3.8642543300284953`*^9, 3.8642547940236826`*^9, 3.872920228555212*^9, 
   3.8729203256008043`*^9, 3.872920583919051*^9, 3.894337725305843*^9, 
   3.8955447141454706`*^9, 3.8955447846488953`*^9, 3.8955450454236436`*^9, 
   3.8968388977555027`*^9, 3.8994314705584764`*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"dd7e38a3-d1c4-463b-800a-8747aa17b23b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrXYZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx_i\>\"", ",", "\"\<Sy_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sx_j\>\"", 
       ",", "\"\<Sy_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.895544599707526*^9, 3.8955447110168276`*^9}, {
  3.8955448571508827`*^9, 3.895544868650812*^9}, {3.89683890226023*^9, 
  3.896838903012211*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"b588ea67-15ba-4b1c-88c8-7865d0e48fc8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 4}\"\>", "\<\"Sx_j\"\>", "\<\"Sy_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sx_i\"\>", 
      RowBox[{"-", "0.07725553375275233`"}], "0", "0"},
     {"\<\"Sy_i\"\>", "0", 
      RowBox[{"-", "0.07725553375275233`"}], "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.07725553375275233`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8955447196727743`*^9, 3.8955447857254744`*^9, {3.89554485008597*^9, 
   3.8955448691965365`*^9}, 3.8955450480871487`*^9, 3.8968389381455054`*^9, 
   3.899431473798858*^9},
 CellLabel->
  "Out[26]//MatrixForm=",ExpressionUUID->"2d34ecb0-6162-4778-88b0-\
3c73edc5b8b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrPMZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sp_i\>\"", ",", "\"\<Sm_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sp_j\>\"", 
       ",", "\"\<Sm_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8968389446443443`*^9, 3.89683895358187*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"a601a36c-360f-4988-bd05-a1d8ef123964"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 4}\"\>", "\<\"Sp_j\"\>", "\<\"Sm_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sp_i\"\>", "0", 
      RowBox[{"-", "0.15451106750550467`"}], "0"},
     {"\<\"Sm_i\"\>", 
      RowBox[{"-", "0.15451106750550467`"}], "0", "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.07725553375275233`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.896838954597859*^9, 3.8994314759535065`*^9},
 CellLabel->
  "Out[28]//MatrixForm=",ExpressionUUID->"c7a78eb5-b934-4dd7-9eab-\
935740062ad7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"hami", "[", 
    RowBox[{"(*", "Jx_", "*)"}], 
    RowBox[{"0.0", ",", 
     RowBox[{"(*", "Jy_", "*)"}], "0.0", ",", 
     RowBox[{"(*", "Jz_", "*)"}], "0.0", ",", 
     RowBox[{"(*", "Dx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Dy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Dz_", "*)"}], "1", ",", 
     RowBox[{"(*", "Gx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Gy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Gz_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hz_", "*)"}], "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"mat", ",", "1", ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Arnoldi\>\"", ",", 
        RowBox[{"\"\<Shift\>\"", "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"Norm", "[", 
           RowBox[{"mat", ",", "2"}], "]"}]}]}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"val0", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"vec0", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "val0", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"GetMag", "[", 
           RowBox[{"vec0", ",", "posi", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NS"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx\>\"", ",", "\"\<Sy\>\"", ",", "\"\<Sz\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "NS"}], "}"}]}], "]"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetEE", "[", 
   RowBox[{"vec0", ",", "posi", ",", 
    RowBox[{"NS", "/", "2"}]}], "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8642525103765283`*^9, 3.864252604165722*^9}, {
   3.8642526447350073`*^9, 3.86425265969335*^9}, {3.864252947935561*^9, 
   3.8642529536547055`*^9}, {3.86425426295756*^9, 3.8642543297093*^9}, {
   3.872919635099105*^9, 3.87291966371762*^9}, {3.872920513802191*^9, 
   3.872920516133121*^9}, {3.895544962817142*^9, 3.8955449800090413`*^9}, {
   3.8955452449502697`*^9, 3.8955452523912587`*^9}, {3.89554531127862*^9, 
   3.8955453133579817`*^9}, {3.8955455442421865`*^9, 3.895545548253487*^9}, 
   3.8994314857934585`*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"8e99c588-bfe3-47dc-91f7-9bca0d643a80"],

Cell[BoxData[
 RowBox[{"-", "1.7320508075688774`"}]], "Print",
 CellChangeTimes->{3.8955449838042283`*^9, 3.8955450493356447`*^9, 
  3.8955452534146566`*^9, 3.8955453140719013`*^9, 3.8955455488644094`*^9, 
  3.896838961695098*^9, 3.8994314874181457`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[29]:=",ExpressionUUID->"2ddebb9e-a324-4075-8da7-\
047dc826b114"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "2", "3", "4", "5", "6"},
     {"\<\"Sx\"\>", "0", "0", "0", "0", "0", "0"},
     {"\<\"Sy\"\>", "0", "0", "0", "0", "0", "0"},
     {"\<\"Sz\"\>", 
      RowBox[{"-", "0.12659761069275444`"}], "0.1265976106927544`", 
      RowBox[{"-", "0.1265976106927544`"}], "0.12659761069275433`", 
      RowBox[{"-", "0.12659761069275435`"}], "0.1265976106927545`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.89554498380722*^9, 3.8955450493376417`*^9, 
  3.8955452534166503`*^9, 3.895545314075605*^9, 3.8955455488674603`*^9, 
  3.896838961699115*^9, 3.899431487421137*^9},
 CellLabel->
  "Out[33]//MatrixForm=",ExpressionUUID->"10fbfadb-b8e0-490e-aead-\
a265ff254f5a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0068819`", ",", "0.9257111992752067`"}], "}"}]], "Output",
 CellChangeTimes->{3.89554498380722*^9, 3.8955450493376417`*^9, 
  3.8955452534166503`*^9, 3.895545314075605*^9, 3.8955455488674603`*^9, 
  3.896838961699115*^9, 3.899431487423132*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"2befc46b-9f74-4d4d-af68-73c1e7ab8e6e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrXYZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx_i\>\"", ",", "\"\<Sy_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sx_j\>\"", 
       ",", "\"\<Sy_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.895544599707526*^9, 3.8955447110168276`*^9}, {
   3.8955448571508827`*^9, 3.895544868650812*^9}, 3.895545276874895*^9, {
   3.8968389118836465`*^9, 3.8968389126453733`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"b982cd8c-c61c-4f16-bd78-9e2638b20574"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 2}\"\>", "\<\"Sx_j\"\>", "\<\"Sy_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sx_i\"\>", "0", 
      RowBox[{"-", "0.0901369613398538`"}], "0"},
     {"\<\"Sy_i\"\>", "0.0901369613398538`", "0", "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.0485256422314434`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.895544992721786*^9, 3.895545053211773*^9, {3.8955452705677032`*^9, 
   3.8955452776480894`*^9}, 3.8955453181019073`*^9, 3.8955455517379026`*^9, 
   3.896838967321315*^9, 3.8994314904777966`*^9},
 CellLabel->
  "Out[36]//MatrixForm=",ExpressionUUID->"7209d609-323e-4108-b48b-\
80f8831ade01"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrPMZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sp_i\>\"", ",", "\"\<Sm_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sp_j\>\"", 
       ",", "\"\<Sm_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.896838974069379*^9, 3.896838983723711*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"3773fa6f-aa1f-4021-a9bf-6ca8b0d100ab"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 2}\"\>", "\<\"Sp_j\"\>", "\<\"Sm_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sp_i\"\>", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.1802739226797076`", " ", "\[ImaginaryI]"}]}], "0"},
     {"\<\"Sm_i\"\>", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.1802739226797076`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.0485256422314434`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.896838991644908*^9, 3.8994314917875285`*^9},
 CellLabel->
  "Out[38]//MatrixForm=",ExpressionUUID->"03e490ed-42fa-4cbb-acdd-\
ad3dbb758a46"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrXYZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx_i\>\"", ",", "\"\<Sy_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sx_j\>\"", 
       ",", "\"\<Sy_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.895545008053232*^9, 3.8955450086926546`*^9}, 
   3.8955452805425596`*^9, 3.896838921237594*^9},
 CellLabel->"In[39]:=",ExpressionUUID->"7057e4bf-e6f1-4efd-a651-f65b9568374b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={2, 1}\"\>", "\<\"Sx_j\"\>", "\<\"Sy_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sx_i\"\>", "0", "0.0901369613398538`", "0"},
     {"\<\"Sy_i\"\>", 
      RowBox[{"-", "0.0901369613398538`"}], "0", "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.0485256422314434`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8955450096033735`*^9, 3.895545056553382*^9, 3.895545281442421*^9, 
   3.895545321978763*^9, 3.895545552752858*^9, {3.8968389688310537`*^9, 
   3.896838993035163*^9}, 3.8994314942856264`*^9},
 CellLabel->
  "Out[40]//MatrixForm=",ExpressionUUID->"a0a98158-41f9-46ef-889b-\
2ce1f8e03b42"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrPMZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sp_i\>\"", ",", "\"\<Sm_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sp_j\>\"", 
       ",", "\"\<Sm_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.89683898900631*^9, 3.8968389905553703`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"d255a988-1fd1-4c4f-b86b-ba38ac86d726"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={2, 1}\"\>", "\<\"Sp_j\"\>", "\<\"Sm_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sp_i\"\>", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.1802739226797076`", " ", "\[ImaginaryI]"}]}], "0"},
     {"\<\"Sm_i\"\>", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.1802739226797076`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.0485256422314434`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.896838994343642*^9, 3.899431494860322*^9},
 CellLabel->
  "Out[42]//MatrixForm=",ExpressionUUID->"69458625-406f-4641-898a-\
223f318561bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"hami", "[", 
    RowBox[{"(*", "Jx_", "*)"}], 
    RowBox[{"1.0", ",", 
     RowBox[{"(*", "Jy_", "*)"}], "0.8", ",", 
     RowBox[{"(*", "Jz_", "*)"}], "0.7", ",", 
     RowBox[{"(*", "Dx_", "*)"}], "0.2", ",", 
     RowBox[{"(*", "Dy_", "*)"}], "0.1", ",", 
     RowBox[{"(*", "Dz_", "*)"}], "5.0", ",", 
     RowBox[{"(*", "Gx_", "*)"}], "0.1", ",", 
     RowBox[{"(*", "Gy_", "*)"}], "0.3", ",", 
     RowBox[{"(*", "Gz_", "*)"}], 
     RowBox[{"-", "0.2"}], ",", 
     RowBox[{"(*", "Hx_", "*)"}], "0.1", ",", 
     RowBox[{"(*", "Hy_", "*)"}], "0.1", ",", 
     RowBox[{"(*", "Hz_", "*)"}], "0.3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"mat", ",", "1", ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Arnoldi\>\"", ",", 
        RowBox[{"\"\<Shift\>\"", "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"Norm", "[", 
           RowBox[{"mat", ",", "2"}], "]"}]}]}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"val0", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"vec0", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "val0", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"GetMag", "[", 
           RowBox[{"vec0", ",", "posi", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NS"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx\>\"", ",", "\"\<Sy\>\"", ",", "\"\<Sz\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "NS"}], "}"}]}], "]"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetEE", "[", 
   RowBox[{"vec0", ",", "posi", ",", 
    RowBox[{"NS", "/", "2"}]}], "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8642525103765283`*^9, 3.864252604165722*^9}, {
  3.8642526447350073`*^9, 3.86425265969335*^9}, {3.864252947935561*^9, 
  3.8642529536547055`*^9}, {3.86425426295756*^9, 3.8642543297093*^9}, {
  3.872919635099105*^9, 3.87291966371762*^9}, {3.872920513802191*^9, 
  3.872920516133121*^9}, {3.895544962817142*^9, 3.8955449800090413`*^9}, {
  3.8955452449502697`*^9, 3.8955452523912587`*^9}, {3.89554531127862*^9, 
  3.8955453133579817`*^9}, {3.8955455442421865`*^9, 3.895545548253487*^9}, {
  3.896839025643938*^9, 3.8968390811172094`*^9}, {3.8994314986332903`*^9, 
  3.8994315034920654`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"b1e117ac-2bb3-454f-9aef-96ff63cc6b04"],

Cell[BoxData[
 RowBox[{"-", "10.061310078974763`"}]], "Print",
 CellChangeTimes->{{3.896839042579862*^9, 3.896839081967514*^9}, 
   3.8994315045132275`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[43]:=",ExpressionUUID->"37859a1c-2109-46e0-bf5f-\
b1ac5c767b02"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "2", "3", "4", "5", "6"},
     {"\<\"Sx\"\>", "0.001672989926265541`", "0.0016729899262655466`", 
      "0.0016729899262655581`", "0.0016729899262655325`", 
      "0.0016729899262655503`", "0.0016729899262655536`"},
     {"\<\"Sy\"\>", "0.0018939392894267411`", "0.0018939392894267567`", 
      "0.0018939392894267405`", "0.001893939289426745`", 
      "0.0018939392894267524`", "0.0018939392894267333`"},
     {"\<\"Sz\"\>", 
      RowBox[{"-", "0.00014056017543243038`"}], 
      RowBox[{"-", "0.000140560175432531`"}], 
      RowBox[{"-", "0.00014056017543248242`"}], 
      RowBox[{"-", "0.0001405601754326559`"}], 
      RowBox[{"-", "0.0001405601754325414`"}], 
      RowBox[{"-", "0.00014056017543256916`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8968390425838485`*^9, 3.8968390819715033`*^9}, 
   3.899431504516884*^9},
 CellLabel->
  "Out[47]//MatrixForm=",ExpressionUUID->"83738f80-298a-40e9-8e30-\
b40e4f0f1546"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0151057`", ",", "0.9536062666664766`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8968390425838485`*^9, 3.8968390819715033`*^9}, 
   3.8994315045378923`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"8e48cc59-8953-4d55-a5f2-d6de5b34bf88"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrXYZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx_i\>\"", ",", "\"\<Sy_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sx_j\>\"", 
       ",", "\"\<Sy_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.895544599707526*^9, 3.8955447110168276`*^9}, {
   3.8955448571508827`*^9, 3.895544868650812*^9}, 3.895545276874895*^9, {
   3.8968389118836465`*^9, 3.8968389126453733`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"9ca11734-96af-4cea-b7d9-3393e6c250a3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 2}\"\>", "\<\"Sx_j\"\>", "\<\"Sy_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sx_i\"\>", 
      RowBox[{"-", "0.08345774097451673`"}], 
      RowBox[{"-", "0.14387576708147748`"}], 
      RowBox[{"-", "0.00012027409037654747`"}]},
     {"\<\"Sy_i\"\>", "0.1436633770743282`", 
      RowBox[{"-", "0.0831871173561883`"}], 
      RowBox[{"-", "0.009204362410119965`"}]},
     {"\<\"Sz_i\"\>", 
      RowBox[{"-", "0.006909212608663673`"}], "0.0066713347521368815`", 
      RowBox[{"-", "0.11813375513809249`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8968391743787746`*^9, 3.899431510765051*^9},
 CellLabel->
  "Out[50]//MatrixForm=",ExpressionUUID->"be8c79e2-ae5d-40ea-95b4-\
2719a2bd0712"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrPMZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sp_i\>\"", ",", "\"\<Sm_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sp_j\>\"", 
       ",", "\"\<Sm_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.896838974069379*^9, 3.896838983723711*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"e0a4ee7a-ffb8-4851-9113-45cf557fc3d1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 2}\"\>", "\<\"Sp_j\"\>", "\<\"Sm_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sp_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.00027062361832844785`"}], "-", 
       RowBox[{"0.00021239000714929623`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.16664485833070503`"}], "+", 
       RowBox[{"0.2875391441558056`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0001202740903765479`"}], "-", 
       RowBox[{"0.009204362410119965`", " ", "\[ImaginaryI]"}]}]},
     {"\<\"Sm_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.16664485833070503`"}], "-", 
       RowBox[{"0.2875391441558056`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.00027062361832844785`"}], "+", 
       RowBox[{"0.00021239000714929623`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0001202740903765479`"}], "+", 
       RowBox[{"0.009204362410119965`", " ", "\[ImaginaryI]"}]}]},
     {"\<\"Sz_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.006909212608663673`"}], "+", 
       RowBox[{"0.006671334752136882`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.006909212608663673`"}], "-", 
       RowBox[{"0.006671334752136882`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.11813375513809249`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.896839045686819*^9, 3.89683907451579*^9}, 
   3.8994315115132294`*^9},
 CellLabel->
  "Out[52]//MatrixForm=",ExpressionUUID->"eefa061f-48cc-4c56-b71b-\
e53ed7e3287f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrPMZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sp_i\>\"", ",", "\"\<Sm_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sp_j\>\"", 
       ",", "\"\<Sm_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.896839096031066*^9, 3.896839103621807*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"4041ef98-c99a-44b6-a41f-8384c64df965"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={2, 1}\"\>", "\<\"Sp_j\"\>", "\<\"Sm_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sp_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.00027062361832844785`"}], "-", 
       RowBox[{"0.00021239000714929623`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.16664485833070503`"}], "-", 
       RowBox[{"0.2875391441558056`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.006909212608663673`"}], "+", 
       RowBox[{"0.006671334752136882`", " ", "\[ImaginaryI]"}]}]},
     {"\<\"Sm_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.16664485833070503`"}], "+", 
       RowBox[{"0.2875391441558056`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.00027062361832844785`"}], "+", 
       RowBox[{"0.00021239000714929623`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.006909212608663673`"}], "-", 
       RowBox[{"0.006671334752136882`", " ", "\[ImaginaryI]"}]}]},
     {"\<\"Sz_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.0001202740903765479`"}], "-", 
       RowBox[{"0.009204362410119965`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0001202740903765479`"}], "+", 
       RowBox[{"0.009204362410119965`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.11813375513809249`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.896839098243372*^9, 3.89683910472995*^9}, 
   3.8994315134416914`*^9},
 CellLabel->
  "Out[54]//MatrixForm=",ExpressionUUID->"fb1ae3e0-13c4-4244-a025-\
22e74f2f2451"]
}, Open  ]]
},
WindowSize->{1440., 741.75},
WindowMargins->{{-6, Automatic}, {Automatic, -6}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
Magnification:>1.2 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (2022\:5e742\:67084\
\:65e5)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"13df6350-c63f-46ee-bc71-498b852a2ea2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2448, 71, 267, "Input",ExpressionUUID->"d1f9668e-5699-4eab-b05b-3a893d4f2097"],
Cell[3009, 93, 1328, 27, 93, "Input",ExpressionUUID->"eefab55a-d9f5-41d4-8c6b-d3c74d69dea7"],
Cell[4340, 122, 3011, 78, 260, "Input",ExpressionUUID->"695e3440-164c-4828-854a-67815aef1456"],
Cell[CellGroupData[{
Cell[7376, 204, 1339, 34, 149, "Input",ExpressionUUID->"86e637fc-830a-4417-8768-18c80ed3f109"],
Cell[8718, 240, 2008, 37, 61, "Output",ExpressionUUID->"8ad23f95-13b9-49b4-abda-067811b06aa2"],
Cell[10729, 279, 2010, 37, 61, "Output",ExpressionUUID->"277940c9-549b-4c24-b118-6914ea920b39"],
Cell[12742, 318, 2010, 37, 61, "Output",ExpressionUUID->"8ff6f531-4e63-454f-b03a-9f60697157f2"]
}, Open  ]],
Cell[14767, 358, 11649, 264, 554, "Input",ExpressionUUID->"468dd902-6354-44f1-b520-9401842ecba0"],
Cell[26419, 624, 998, 26, 48, "Input",ExpressionUUID->"3806b937-f7f0-46ac-afb7-0adb4b6bfaa1"],
Cell[27420, 652, 2843, 79, 113, "Input",ExpressionUUID->"55b2ec24-2297-4314-8f9a-234ed8abcf6c"],
Cell[30266, 733, 2744, 78, 113, "Input",ExpressionUUID->"69025ebf-6895-4ab0-bd8a-3745eace2945"],
Cell[33013, 813, 7661, 199, 936, "Input",ExpressionUUID->"cbf716ff-aa25-4262-9080-7090d4d44064"],
Cell[CellGroupData[{
Cell[40699, 1016, 2808, 74, 261, "Input",ExpressionUUID->"e41a7eed-97c1-419d-a9b4-f187d312d836"],
Cell[43510, 1092, 606, 11, 26, "Print",ExpressionUUID->"e2ea2c1a-eb4c-41e4-b36c-79cea39c3cfe"],
Cell[44119, 1105, 1175, 27, 120, "Output",ExpressionUUID->"44098b30-d700-44a0-ae54-64721484c37c"],
Cell[45297, 1134, 618, 10, 61, "Output",ExpressionUUID->"dd7e38a3-d1c4-463b-800a-8747aa17b23b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45952, 1149, 1184, 32, 130, "Input",ExpressionUUID->"b588ea67-15ba-4b1c-88c8-7865d0e48fc8"],
Cell[47139, 1183, 1058, 28, 123, "Output",ExpressionUUID->"2d34ecb0-6162-4778-88b0-3c73edc5b8b6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48234, 1216, 1084, 30, 130, "Input",ExpressionUUID->"a601a36c-360f-4988-bd05-a1d8ef123964"],
Cell[49321, 1248, 928, 25, 123, "Output",ExpressionUUID->"c7a78eb5-b934-4dd7-9eab-935740062ad7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50286, 1278, 2989, 77, 261, "Input",ExpressionUUID->"8e99c588-bfe3-47dc-91f7-9bca0d643a80"],
Cell[53278, 1357, 362, 7, 26, "Print",ExpressionUUID->"2ddebb9e-a324-4075-8da7-047dc826b114"],
Cell[53643, 1366, 1101, 26, 120, "Output",ExpressionUUID->"10fbfadb-b8e0-490e-aead-a265ff254f5a"],
Cell[54747, 1394, 364, 6, 61, "Output",ExpressionUUID->"2befc46b-9f74-4d4d-af68-73c1e7ab8e6e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55148, 1405, 1213, 32, 130, "Input",ExpressionUUID->"b982cd8c-c61c-4f16-bd78-9e2638b20574"],
Cell[56364, 1439, 1056, 27, 123, "Output",ExpressionUUID->"7209d609-323e-4108-b48b-80f8831ade01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57457, 1471, 1083, 30, 130, "Input",ExpressionUUID->"3773fa6f-aa1f-4021-a9bf-6ca8b0d100ab"],
Cell[58543, 1503, 1059, 27, 123, "Output",ExpressionUUID->"03e490ed-42fa-4cbb-acdd-ad3dbb758a46"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59639, 1535, 1135, 31, 130, "Input",ExpressionUUID->"7057e4bf-e6f1-4efd-a651-f65b9568374b"],
Cell[60777, 1568, 1052, 27, 123, "Output",ExpressionUUID->"a0a98158-41f9-46ef-889b-2ce1f8e03b42"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61866, 1600, 1084, 30, 130, "Input",ExpressionUUID->"d255a988-1fd1-4c4f-b86b-ba38ac86d726"],
Cell[62953, 1632, 1057, 27, 123, "Output",ExpressionUUID->"69458625-406f-4641-898a-223f318561bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64047, 1664, 3091, 79, 261, "Input",ExpressionUUID->"b1e117ac-2bb3-454f-9aef-96ff63cc6b04"],
Cell[67141, 1745, 264, 6, 26, "Print",ExpressionUUID->"37859a1c-2109-46e0-bf5f-b1ac5c767b02"],
Cell[67408, 1753, 1373, 32, 120, "Output",ExpressionUUID->"83738f80-298a-40e9-8e30-b40e4f0f1546"],
Cell[68784, 1787, 277, 5, 61, "Output",ExpressionUUID->"8e48cc59-8953-4d55-a5f2-d6de5b34bf88"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69098, 1797, 1213, 32, 130, "Input",ExpressionUUID->"9ca11734-96af-4cea-b7d9-3393e6c250a3"],
Cell[70314, 1831, 1135, 29, 123, "Output",ExpressionUUID->"be8c79e2-ae5d-40ea-95b4-2719a2bd0712"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71486, 1865, 1083, 30, 130, "Input",ExpressionUUID->"e0a4ee7a-ffb8-4851-9113-45cf557fc3d1"],
Cell[72572, 1897, 1917, 48, 123, "Output",ExpressionUUID->"eefa061f-48cc-4c56-b71b-e53ed7e3287f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74526, 1950, 1083, 30, 130, "Input",ExpressionUUID->"4041ef98-c99a-44b6-a41f-8384c64df965"],
Cell[75612, 1982, 1917, 48, 123, "Output",ExpressionUUID->"fb1ae3e0-13c4-4244-a025-22e74f2f2451"]
}, Open  ]]
}
]
*)

