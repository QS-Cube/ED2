(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     82081,       2103]
NotebookOptionsPosition[     76896,       2013]
NotebookOutlinePosition[     77568,       2035]
CellTagsIndexPosition[     77525,       2032]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sz", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"Table", "[", 
      RowBox[{"ii", ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "SS", ",", 
         RowBox[{"-", "SS"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sp", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"SS", 
          RowBox[{"(", 
           RowBox[{"SS", "+", "1"}], ")"}]}], "-", 
         RowBox[{"jj", 
          RowBox[{"(", 
           RowBox[{"jj", "+", "1"}], ")"}]}]}]], 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"ii", ",", 
         RowBox[{"jj", "+", "1"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "SS", ",", 
        RowBox[{"-", "SS"}], ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "SS", ",", 
        RowBox[{"-", "SS"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sx", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"Sp", "+", 
      RowBox[{"Sp", "\[Transpose]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sy", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", "\[ImaginaryI]"}]], 
    RowBox[{"(", 
     RowBox[{"Sp", "-", 
      RowBox[{"Sp", "\[Transpose]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"II", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{
      RowBox[{"2", "SS"}], "+", "1"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8590126932424097`*^9, 3.8590128932112803`*^9}, {
   3.8590147128192883`*^9, 3.859014724028838*^9}, {3.8590147981878066`*^9, 
   3.8590148088017583`*^9}, {3.8590149071904373`*^9, 
   3.8590149074067397`*^9}, {3.8608462988447695`*^9, 3.8608463077173653`*^9}, 
   3.860846441572929*^9, {3.860847318732803*^9, 3.8608473279598017`*^9}, {
   3.8608473956579404`*^9, 3.8608474079702573`*^9}, {3.8716778381239443`*^9, 
   3.871677850384023*^9}, {3.895544404055787*^9, 3.8955444090858555`*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"d1f9668e-5699-4eab-b05b-3a893d4f2097"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NS", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NODmin", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NODmax", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Szmax", "=", 
   RowBox[{
    RowBox[{"NS", "*", "SS"}], "-", "NODmin"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Szmin", "=", 
    RowBox[{
     RowBox[{"NS", "*", "SS"}], "-", "NODmax"}]}], ";"}], " "}]}], "Input",
 CellChangeTimes->{
  3.835748605111039*^9, {3.835748639232997*^9, 3.8357486466808863`*^9}, {
   3.846896778081738*^9, 3.8468967783292828`*^9}, {3.84690270158916*^9, 
   3.846902702122139*^9}, {3.8469027553996983`*^9, 3.8469027561551237`*^9}, {
   3.852533300621213*^9, 3.852533300757848*^9}, {3.8525359328591137`*^9, 
   3.8525359329527493`*^9}, 3.858827546065132*^9, {3.859011740655818*^9, 
   3.8590117715174522`*^9}, 3.8590118420963106`*^9, {3.8590148170312967`*^9, 
   3.859014866696488*^9}, {3.8650535165518136`*^9, 3.865053527019821*^9}, {
   3.872919072138908*^9, 3.872919082435092*^9}, {3.872919555982209*^9, 
   3.8729195870280137`*^9}, {3.894337669350979*^9, 3.89433767150371*^9}, {
   3.8955444126009626`*^9, 3.8955444166584373`*^9}, 3.8955450309256983`*^9, {
   3.8989098329309235`*^9, 3.8989098777175484`*^9}, {3.899284007955349*^9, 
   3.899284009618865*^9}, {3.899284444828186*^9, 3.8992844465560527`*^9}, {
   3.899285148271392*^9, 3.8992851489438896`*^9}, {3.899336909249284*^9, 
   3.899336931984706*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"eefab55a-d9f5-41d4-8c6b-d3c74d69dea7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"mSx", "[", "nn", "]"}], "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "NS"}], "}"}]}], "]"}], ",", 
           RowBox[{"nn", "\[Rule]", "Sx"}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mSy", "[", "nn", "]"}], "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "NS"}], "}"}]}], "]"}], ",", 
           RowBox[{"nn", "\[Rule]", "Sy"}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mSp", "[", "nn", "]"}], "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "NS"}], "}"}]}], "]"}], ",", 
           RowBox[{"nn", "\[Rule]", "Sp"}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mSm", "[", "nn", "]"}], "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "NS"}], "}"}]}], "]"}], ",", 
           RowBox[{"nn", "\[Rule]", 
            RowBox[{"Sp", "\[Transpose]"}]}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mSz", "[", "nn", "]"}], "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "NS"}], "}"}]}], "]"}], ",", 
           RowBox[{"nn", "\[Rule]", "Sz"}]}], "]"}]}], "]"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"nn", ",", "1", ",", "NS", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.835748649302706*^9, 3.835748650532366*^9}, {
   3.84690209825313*^9, 3.846902099565158*^9}, {3.846904128746945*^9, 
   3.846904142986796*^9}, 3.85253511842143*^9, {3.8590118551704464`*^9, 
   3.8590118661995497`*^9}, {3.896838828581442*^9, 3.896838843718651*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"695e3440-164c-4828-854a-67815aef1456"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Jbonds", "=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "2", ",", "3", ",", "3", ",", "4", ",", "4", ",", 
      "5", ",", "5", ",", "6", ",", "6", ",", "1"}], "}"}], ",", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Dbonds", "=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "2", ",", "3", ",", "3", ",", "4", ",", "4", ",", 
      "5", ",", "5", ",", "6", ",", "6", ",", "1"}], "}"}], ",", "2"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8357486599603558`*^9, 3.835748670994281*^9}, {
  3.835749088559271*^9, 3.8357491645919*^9}, {3.846896799932757*^9, 
  3.846896834106448*^9}, {3.846896920569708*^9, 3.846897081504879*^9}, {
  3.852299097128045*^9, 3.8522991828429213`*^9}, {3.852299214768203*^9, 
  3.852299309150056*^9}, {3.8525333161540117`*^9, 3.852533451982788*^9}, {
  3.85253593929469*^9, 3.852535961527195*^9}, {3.852536004038513*^9, 
  3.852536064055562*^9}, {3.858827554924971*^9, 3.8588275630289865`*^9}, {
  3.85901187192725*^9, 3.8590118741542244`*^9}, {3.859014894056341*^9, 
  3.8590149004771647`*^9}, {3.865053533870576*^9, 3.8650535390189323`*^9}, {
  3.8729195973360806`*^9, 3.872919614327981*^9}, {3.872920056143998*^9, 
  3.872920057707058*^9}, {3.894337691561344*^9, 3.8943376941893806`*^9}, {
  3.8943378227453527`*^9, 3.894337823771959*^9}, {3.8955444292708526`*^9, 
  3.895544436398663*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"86e637fc-830a-4417-8768-18c80ed3f109"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.835749177213112*^9, 3.835751609937346*^9, 3.8360032225057573`*^9, 
   3.836005281024932*^9, 3.836008014496929*^9, 3.83600973694934*^9, 
   3.836011841702182*^9, 3.83601372087687*^9, 3.839593063242775*^9, 
   3.843165780684718*^9, 3.843182084320368*^9, 3.8437902686806107`*^9, 
   3.8437971291717987`*^9, 3.844211815954352*^9, 3.844230275774041*^9, 
   3.846896941973054*^9, {3.8468970561574163`*^9, 3.846897082925179*^9}, 
   3.8468974975199947`*^9, 3.8468977222678623`*^9, 3.846903734170856*^9, 
   3.847498809897109*^9, 3.848627119491132*^9, 3.8522991409096117`*^9, 
   3.8522991834402637`*^9, {3.852299284073073*^9, 3.852299313543104*^9}, 
   3.852303033106797*^9, 3.8523034015807333`*^9, 3.8525217210355773`*^9, 
   3.8525230941989717`*^9, 3.8525334787850513`*^9, 3.852536065740768*^9, 
   3.852537897177081*^9, 3.8525394890281763`*^9, 3.852539775238*^9, 
   3.8525399313468227`*^9, 3.8525404489747667`*^9, 3.853847015003517*^9, 
   3.856381825526411*^9, 3.8588275649866505`*^9, 3.859011930816147*^9, 
   3.859014910482568*^9, 3.859423136641081*^9, 3.8594231980213947`*^9, {
   3.8594233168689013`*^9, 3.859423351091732*^9}, 3.8594272714553223`*^9, 
   3.8642523935252695`*^9, 3.865053540478675*^9, 3.872919489993284*^9, 
   3.8729196154857426`*^9, {3.8729200403053093`*^9, 3.872920058880395*^9}, 
   3.894337696042715*^9, 3.8943378247847176`*^9, 3.8955444386798205`*^9, 
   3.8955450388388042`*^9, 3.895545229188249*^9, 3.8955470428599987`*^9, 
   3.896838852407874*^9, 3.8989098833437214`*^9, 3.8992840300265026`*^9, 
   3.8992844668428717`*^9, 3.8992851675853963`*^9, 3.899334978082181*^9, {
   3.899336913713696*^9, 3.899336940987092*^9}},
 CellLabel->
  "Out[156]=",ExpressionUUID->"acdf47df-1706-4cce-97a4-839f76d2ee37"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.835749177213112*^9, 3.835751609937346*^9, 3.8360032225057573`*^9, 
   3.836005281024932*^9, 3.836008014496929*^9, 3.83600973694934*^9, 
   3.836011841702182*^9, 3.83601372087687*^9, 3.839593063242775*^9, 
   3.843165780684718*^9, 3.843182084320368*^9, 3.8437902686806107`*^9, 
   3.8437971291717987`*^9, 3.844211815954352*^9, 3.844230275774041*^9, 
   3.846896941973054*^9, {3.8468970561574163`*^9, 3.846897082925179*^9}, 
   3.8468974975199947`*^9, 3.8468977222678623`*^9, 3.846903734170856*^9, 
   3.847498809897109*^9, 3.848627119491132*^9, 3.8522991409096117`*^9, 
   3.8522991834402637`*^9, {3.852299284073073*^9, 3.852299313543104*^9}, 
   3.852303033106797*^9, 3.8523034015807333`*^9, 3.8525217210355773`*^9, 
   3.8525230941989717`*^9, 3.8525334787850513`*^9, 3.852536065740768*^9, 
   3.852537897177081*^9, 3.8525394890281763`*^9, 3.852539775238*^9, 
   3.8525399313468227`*^9, 3.8525404489747667`*^9, 3.853847015003517*^9, 
   3.856381825526411*^9, 3.8588275649866505`*^9, 3.859011930816147*^9, 
   3.859014910482568*^9, 3.859423136641081*^9, 3.8594231980213947`*^9, {
   3.8594233168689013`*^9, 3.859423351091732*^9}, 3.8594272714553223`*^9, 
   3.8642523935252695`*^9, 3.865053540478675*^9, 3.872919489993284*^9, 
   3.8729196154857426`*^9, {3.8729200403053093`*^9, 3.872920058880395*^9}, 
   3.894337696042715*^9, 3.8943378247847176`*^9, 3.8955444386798205`*^9, 
   3.8955450388388042`*^9, 3.895545229188249*^9, 3.8955470428599987`*^9, 
   3.896838852407874*^9, 3.8989098833437214`*^9, 3.8992840300265026`*^9, 
   3.8992844668428717`*^9, 3.8992851675853963`*^9, 3.899334978082181*^9, {
   3.899336913713696*^9, 3.89933694099728*^9}},
 CellLabel->
  "Out[157]=",ExpressionUUID->"932ef338-3fe2-4ce6-8a31-37e601bedcd4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hami", "[", 
    RowBox[{
    "Jx_", ",", "Jy_", ",", "Jz_", ",", "Dx_", ",", "Dy_", ",", "Dz_", ",", 
     "Hx_", ",", "Hy_", ",", "Hz_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"HAll", "=", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Jx", " ", 
             RowBox[{
              RowBox[{"mSx", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
              RowBox[{"mSx", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "+", 
            RowBox[{"Jy", " ", 
             RowBox[{
              RowBox[{"mSy", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
              RowBox[{"mSy", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], " ", "+", 
            RowBox[{"Jz", " ", 
             RowBox[{
              RowBox[{"mSz", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
              RowBox[{"mSz", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}], ")"}], "&"}], "/@",
          "Jbonds"}], "]"}], "+", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Dx", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}]}], "+", 
            RowBox[{"Dy", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}]}], " ", 
            "+", 
            RowBox[{"Dz", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}]}]}], ")"}],
           "&"}], "/@", "Dbonds"}], "]"}], "-", 
       RowBox[{"Hx", " ", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mSx", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "NS", "]"}]}], "]"}]}], "-", 
       RowBox[{"Hy", " ", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mSy", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "NS", "]"}]}], "]"}]}], "-", 
       RowBox[{"Hz", " ", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mSz", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "NS", "]"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"When", " ", "U", 
       RowBox[{"(", "1", ")"}], " ", "is", " ", "preserved"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"posi", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Normal", "[", 
            RowBox[{"Diagonal", "[", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"mSz", "[", "#", "]"}], "&"}], "/@", 
               RowBox[{"Range", "[", "NS", "]"}]}], "]"}], "]"}], "]"}], ",", 
           
           RowBox[{"n_", " ", "/;", " ", 
            RowBox[{"n", "==", "SzMin"}]}]}], "]"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"When", " ", "U", 
       RowBox[{"(", "1", ")"}], " ", "is", " ", "not", " ", "preserved"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"posi", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"Diagonal", "[", 
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mSz", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", "NS", "]"}]}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"n_", " ", "/;", " ", 
          RowBox[{"Szmin", "<=", "n", "<=", "Szmax"}]}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"HAll", "[", 
      RowBox[{"[", 
       RowBox[{"posi", ",", "posi"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
    ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.835749236308423*^9, 3.835749259905862*^9}, {
   3.8357493015228033`*^9, 3.835749303802754*^9}, {3.835749354659789*^9, 
   3.835749380677432*^9}, 3.83575003357922*^9, {3.835750321347682*^9, 
   3.835750327923233*^9}, {3.8357505146508102`*^9, 3.835750522514373*^9}, 
   3.835750554553487*^9, {3.8357506131349487`*^9, 3.83575066032944*^9}, {
   3.8357508609895773`*^9, 3.8357509756212683`*^9}, {3.8357510104053793`*^9, 
   3.8357510731009073`*^9}, {3.83575111083736*^9, 3.835751236323717*^9}, {
   3.835751285236122*^9, 3.8357512853313627`*^9}, {3.8357513173800917`*^9, 
   3.835751343347898*^9}, {3.835751412843955*^9, 3.8357515505990763`*^9}, {
   3.835752087984779*^9, 3.8357520977107983`*^9}, 3.835752345270014*^9, {
   3.8357524113105173`*^9, 3.8357524128782167`*^9}, {3.835753832756716*^9, 
   3.8357538742880774`*^9}, {3.836004518178898*^9, 3.8360045491781807`*^9}, {
   3.836005912296547*^9, 3.836006039320539*^9}, {3.8360073943462963`*^9, 
   3.8360074596080837`*^9}, {3.836007573576137*^9, 3.836007655800295*^9}, {
   3.836007698641397*^9, 3.8360077426560297`*^9}, {3.836008185369494*^9, 
   3.836008201575471*^9}, {3.836010023935727*^9, 3.836010117668153*^9}, {
   3.836010583836747*^9, 3.836010587706355*^9}, 3.836010796443634*^9, {
   3.836010827497513*^9, 3.8360108562334337`*^9}, 3.83601090083339*^9, 
   3.8360118287432117`*^9, {3.836012643129567*^9, 3.8360126446043797`*^9}, 
   3.8360136601445093`*^9, {3.846897270947372*^9, 3.846897437409424*^9}, 
   3.846898298265911*^9, {3.8468986612065897`*^9, 3.846898679705593*^9}, {
   3.846902266696879*^9, 3.846902276328711*^9}, {3.846902306580574*^9, 
   3.846902315373189*^9}, 3.846902625885776*^9, {3.8469026558938828`*^9, 
   3.846902658847444*^9}, 3.846902693126952*^9, {3.846903141670808*^9, 
   3.846903243824995*^9}, {3.846903281778387*^9, 3.846903287119923*^9}, 
   3.8469038339750433`*^9, 3.846903888079928*^9, 3.846904017764452*^9, {
   3.846922820876429*^9, 3.8469228256335983`*^9}, {3.846923451552556*^9, 
   3.846923511041894*^9}, {3.846923556563575*^9, 3.84692357164128*^9}, {
   3.846924022930212*^9, 3.846924027593342*^9}, {3.8475025099343157`*^9, 
   3.847502527251458*^9}, {3.848627163557901*^9, 3.848627164147026*^9}, {
   3.852300810023588*^9, 3.852301006315295*^9}, {3.852301201619738*^9, 
   3.852301389073921*^9}, {3.8525335433227606`*^9, 3.852533873334607*^9}, {
   3.852533910943916*^9, 3.8525339439967775`*^9}, {3.8525361047666407`*^9, 
   3.8525361376579323`*^9}, {3.852536168029557*^9, 3.85253622041817*^9}, 
   3.852539764784671*^9, {3.8525408930113363`*^9, 3.85254091038559*^9}, {
   3.858827571779725*^9, 3.8588275774947457`*^9}, {3.858827622968748*^9, 
   3.858827693810526*^9}, {3.8590118848973217`*^9, 3.859012054359379*^9}, {
   3.8590149208349247`*^9, 3.8590149408004956`*^9}, {3.859014973728597*^9, 
   3.8590149986046*^9}, {3.859015186393597*^9, 3.8590152101988306`*^9}, {
   3.85901539062931*^9, 3.8590153963886814`*^9}, 3.8594274215746927`*^9, {
   3.864254178098172*^9, 3.8642541849106507`*^9}, {3.864254216026724*^9, 
   3.864254221263844*^9}, {3.864254775514139*^9, 3.8642547777497854`*^9}, {
   3.87291910138984*^9, 3.8729191626461115`*^9}, {3.895544447687689*^9, 
   3.8955444514722757`*^9}, {3.8989098881307836`*^9, 3.898909898557285*^9}, {
   3.8989099650228844`*^9, 3.898909965137184*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"468dd902-6354-44f1-b520-9401842ecba0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetMag", "[", 
   RowBox[{"vec_", ",", "posi_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"vec", "\[Conjugate]"}], ".", "#", ".", "vec"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"mSx", "[", "i", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"mSy", "[", "i", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"mSz", "[", "i", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"posi", ",", "posi"}], "]"}], "]"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.864252409376627*^9, 3.8642524957199636`*^9}, {
   3.8642526275276723`*^9, 3.864252638742082*^9}, {3.8642544224381*^9, 
   3.86425443232662*^9}, {3.8642544640307865`*^9, 3.864254465854549*^9}, 
   3.8642545779334373`*^9},
 CellLabel->
  "In[159]:=",ExpressionUUID->"3806b937-f7f0-46ac-afb7-0adb4b6bfaa1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCorrXYZ", "[", 
   RowBox[{"vec_", ",", "posi_", ",", "i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vec", "\[Conjugate]"}], ".", "#", ".", "vec"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSx", "[", "i", "]"}], ".", 
          RowBox[{"mSx", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSx", "[", "i", "]"}], ".", 
          RowBox[{"mSy", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSx", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSy", "[", "i", "]"}], ".", 
          RowBox[{"mSx", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSy", "[", "i", "]"}], ".", 
          RowBox[{"mSy", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSy", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSx", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSy", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}]}], "}"}]}], ",", "3"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8955444986817694`*^9, 3.895544554822218*^9}, {
  3.8955447439604673`*^9, 3.895544780754654*^9}, {3.8955448284226255`*^9, 
  3.895544845008439*^9}, {3.8968388638951454`*^9, 3.896838864484391*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"55b2ec24-2297-4314-8f9a-234ed8abcf6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCorrPMZ", "[", 
   RowBox[{"vec_", ",", "posi_", ",", "i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vec", "\[Conjugate]"}], ".", "#", ".", "vec"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSp", "[", "i", "]"}], ".", 
          RowBox[{"mSp", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSp", "[", "i", "]"}], ".", 
          RowBox[{"mSm", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSp", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSm", "[", "i", "]"}], ".", 
          RowBox[{"mSp", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSm", "[", "i", "]"}], ".", 
          RowBox[{"mSm", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSm", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSp", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSm", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}]}], "}"}]}], ",", "3"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8968388118041677`*^9, 3.8968388207510448`*^9}, {
  3.896838860004522*^9, 3.896838887956397*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"69025ebf-6895-4ab0-bd8a-3745eace2945"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Entanglement", " ", "entropy", " ", "when", " ", "divided", " ", "into", 
     " ", "1"}], ",", "2", ",", "...", ",", 
    RowBox[{
     RowBox[{"l", " ", "and", " ", "l"}], "+", "1"}], ",", 
    RowBox[{"l", "+", "2"}], ",", ",", "...", ",", "NOS"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GetEE", "[", 
     RowBox[{"vec_", ",", "posi_", ",", "l_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Make", " ", "density", " ", "matrix"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rho", "=", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"vec", ",", 
          RowBox[{"vec", "\[Conjugate]"}]}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vec", "\[Conjugate]"}], ".", "vec"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Make", " ", "reduced", " ", "density", " ", "matrix", " ", "for", " ",
         "subsystem", " ", "A"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"listAB", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "l"}], "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"l", "+", "1"}], ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PadLeft", "[", 
            RowBox[{
             RowBox[{"IntegerDigits", "[", 
              RowBox[{
               RowBox[{"n", "-", "1"}], ",", 
               RowBox[{
                RowBox[{"2", "SS"}], "+", "1"}]}], "]"}], ",", "NS"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "SS"}], "+", "1"}], ")"}], "^", "NS"}]}], 
            "}"}]}], "]"}], "[", 
         RowBox[{"[", "posi", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"listA", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"listAB", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ruleA", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"listA", "->", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "listA", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"listB", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"listAB", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ruleB", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"listB", "->", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "listB", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"listABNum", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"listAB", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "/.", "ruleA"}], ",", 
          RowBox[{
           RowBox[{"listAB", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "/.", "ruleB"}]}], 
         "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rhoA", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"posiAi", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{"listABNum", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "_"}], "}"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"posiAj", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{"listABNum", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "_"}], "}"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"posiBi", "=", 
           RowBox[{"listABNum", "[", 
            RowBox[{"[", 
             RowBox[{"posiAi", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"posiBj", "=", 
           RowBox[{"listABNum", "[", 
            RowBox[{"[", 
             RowBox[{"posiAj", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"posiBi", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "==", 
               RowBox[{"posiBj", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], ",", 
              RowBox[{"rho", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"posiAi", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], ",", 
                 RowBox[{"posiAj", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "]"}], ",", "0"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", 
              RowBox[{"Length", "[", "posiAi", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"Length", "[", "posiAj", "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "listA", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "listA", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Calculate", " ", "vN", " ", "entropy", " ", "of", " ", "rhoA"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]val0", "=", 
       RowBox[{"Eigenvalues", "[", "rhoA", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]val", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"\[Lambda]val0", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", "#", "]"}], ">", 
           RowBox[{"10", "^", 
            RowBox[{"-", "12"}]}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SA", "=", 
       RowBox[{"-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Lambda]val", "[", 
            RowBox[{"[", "i", "]"}], "]"}], 
           RowBox[{"Log", "[", 
            RowBox[{"\[Lambda]val", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "\[Lambda]val", "]"}]}], "}"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "SA"}], "\[IndentingNewLine]",
      ")"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8729191972377768`*^9, 3.8729192767936335`*^9}, {
   3.872919320206108*^9, 3.872919345327308*^9}, {3.872919379117259*^9, 
   3.872919420690125*^9}, {3.8729194515639973`*^9, 3.872919479388748*^9}, {
   3.8729198377876964`*^9, 3.8729198462977285`*^9}, 3.8729198868614063`*^9, 
   3.872920249031021*^9, {3.872929330240371*^9, 3.87292935496992*^9}, {
   3.872931520318635*^9, 3.8729315360741777`*^9}, 3.8729324099110975`*^9},
 CellLabel->
  "In[162]:=",ExpressionUUID->"cbf716ff-aa25-4262-9080-7090d4d44064"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"hami", "[", 
    RowBox[{"(*", "Jx_", "*)"}], 
    RowBox[{"1.0", ",", 
     RowBox[{"(*", "Jy_", "*)"}], "1.0", ",", 
     RowBox[{"(*", "Jz_", "*)"}], "1.0", ",", 
     RowBox[{"(*", "Dx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Dy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Dz_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hz_", "*)"}], "0."}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"mat", ",", "1", ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Arnoldi\>\"", ",", 
        RowBox[{"\"\<Shift\>\"", "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"Norm", "[", 
           RowBox[{"mat", ",", "2"}], "]"}]}]}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"val0", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"vec0", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "val0", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"GetMag", "[", 
           RowBox[{"vec0", ",", "posi", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NS"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx\>\"", ",", "\"\<Sy\>\"", ",", "\"\<Sz\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "NS"}], "}"}]}], "]"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetEE", "[", 
   RowBox[{"vec0", ",", "posi", ",", 
    RowBox[{"NS", "/", "2"}]}], "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8642525103765283`*^9, 3.864252604165722*^9}, {
  3.8642526447350073`*^9, 3.86425265969335*^9}, {3.864252947935561*^9, 
  3.8642529536547055`*^9}, {3.86425426295756*^9, 3.8642543297093*^9}, {
  3.872919635099105*^9, 3.87291966371762*^9}, {3.872920513802191*^9, 
  3.872920516133121*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"e41a7eed-97c1-419d-a9b4-f187d312d836"],

Cell[BoxData[
 RowBox[{"-", "2.8027756377319943`"}]], "Print",
 CellChangeTimes->{
  3.898909973771023*^9, 3.8992840573430176`*^9, 3.8992844669222155`*^9, 
   3.8992851676867704`*^9, 3.8993349783313885`*^9, {3.899336914084139*^9, 
   3.899336941077936*^9}},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[163]:=",ExpressionUUID->"871b28b9-ae74-4456-\
848e-b603b8a7c39a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "2", "3", "4", "5", "6"},
     {"\<\"Sx\"\>", "0", "0", "0", "0", "0", "0"},
     {"\<\"Sy\"\>", "0", "0", "0", "0", "0", "0"},
     {"\<\"Sz\"\>", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.864252606529915*^9, {3.8642526486543407`*^9, 3.8642526603173027`*^9}, 
   3.864252954783156*^9, 3.864254265914912*^9, 3.864254299172228*^9, 
   3.8642543300284953`*^9, 3.8642547940236826`*^9, 3.872920228555212*^9, 
   3.8729203256008043`*^9, 3.872920583919051*^9, 3.894337725305843*^9, 
   3.8955447141454706`*^9, 3.8955447846488953`*^9, 3.8955450454236436`*^9, 
   3.8968388977555027`*^9, 3.8989099257935057`*^9, 3.898909973785987*^9, 
   3.8992840573800116`*^9, 3.8992844669414787`*^9, 3.8992851676912823`*^9, 
   3.8993349783557215`*^9, {3.8993369140954504`*^9, 3.899336941094922*^9}},
 CellLabel->
  "Out[167]//MatrixForm=",ExpressionUUID->"c20032a4-9529-4073-993e-\
579d53e86505"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.01038`", ",", "0.9590063760890893`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.864252606529915*^9, {3.8642526486543407`*^9, 3.8642526603173027`*^9}, 
   3.864252954783156*^9, 3.864254265914912*^9, 3.864254299172228*^9, 
   3.8642543300284953`*^9, 3.8642547940236826`*^9, 3.872920228555212*^9, 
   3.8729203256008043`*^9, 3.872920583919051*^9, 3.894337725305843*^9, 
   3.8955447141454706`*^9, 3.8955447846488953`*^9, 3.8955450454236436`*^9, 
   3.8968388977555027`*^9, 3.8989099257935057`*^9, 3.898909973785987*^9, 
   3.8992840573800116`*^9, 3.8992844669414787`*^9, 3.8992851676912823`*^9, 
   3.8993349783557215`*^9, {3.8993369140954504`*^9, 3.8993369411017723`*^9}},
 CellLabel->
  "Out[168]=",ExpressionUUID->"4127343a-99f2-4412-8f64-10694757f1c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrXYZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx_i\>\"", ",", "\"\<Sy_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sx_j\>\"", 
       ",", "\"\<Sy_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.895544599707526*^9, 3.8955447110168276`*^9}, {
  3.8955448571508827`*^9, 3.895544868650812*^9}, {3.89683890226023*^9, 
  3.896838903012211*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"b588ea67-15ba-4b1c-88c8-7865d0e48fc8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 4}\"\>", "\<\"Sx_j\"\>", "\<\"Sy_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sx_i\"\>", 
      RowBox[{"-", "0.07725553375275232`"}], "0", "0"},
     {"\<\"Sy_i\"\>", "0", 
      RowBox[{"-", "0.07725553375275232`"}], "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.07725553375275233`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8955447196727743`*^9, 3.8955447857254744`*^9, {3.89554485008597*^9, 
   3.8955448691965365`*^9}, 3.8955450480871487`*^9, 3.8968389381455054`*^9, 
   3.898909975255781*^9, 3.899284064950692*^9, 3.899284466972128*^9, 
   3.899285167726772*^9, 3.8993349784391155`*^9, {3.8993369141951637`*^9, 
   3.899336941130472*^9}},
 CellLabel->
  "Out[170]//MatrixForm=",ExpressionUUID->"9ce68193-5dd5-49ae-b8be-\
8ba643d44eac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrPMZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sp_i\>\"", ",", "\"\<Sm_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sp_j\>\"", 
       ",", "\"\<Sm_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8968389446443443`*^9, 3.89683895358187*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"a601a36c-360f-4988-bd05-a1d8ef123964"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 4}\"\>", "\<\"Sp_j\"\>", "\<\"Sm_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sp_i\"\>", "0", 
      RowBox[{"-", "0.15451106750550464`"}], "0"},
     {"\<\"Sm_i\"\>", 
      RowBox[{"-", "0.15451106750550464`"}], "0", "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.07725553375275233`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.896838954597859*^9, 3.89890997609414*^9, 3.8992840695550456`*^9, 
   3.899284467003161*^9, 3.8992851677649865`*^9, 3.8993349784850206`*^9, {
   3.8993369142134314`*^9, 3.899336941164736*^9}},
 CellLabel->
  "Out[172]//MatrixForm=",ExpressionUUID->"d8a71b7b-2289-40db-b5f3-\
f05a97015682"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"hami", "[", 
    RowBox[{"(*", "Jx_", "*)"}], 
    RowBox[{"0.0", ",", 
     RowBox[{"(*", "Jy_", "*)"}], "0.0", ",", 
     RowBox[{"(*", "Jz_", "*)"}], "0.0", ",", 
     RowBox[{"(*", "Dx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Dy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Dz_", "*)"}], "1", ",", 
     RowBox[{"(*", "Hx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hz_", "*)"}], "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"mat", ",", "1", ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Arnoldi\>\"", ",", 
        RowBox[{"\"\<Shift\>\"", "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"Norm", "[", 
           RowBox[{"mat", ",", "2"}], "]"}]}]}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"val0", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"vec0", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "val0", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"GetMag", "[", 
           RowBox[{"vec0", ",", "posi", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NS"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx\>\"", ",", "\"\<Sy\>\"", ",", "\"\<Sz\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "NS"}], "}"}]}], "]"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetEE", "[", 
   RowBox[{"vec0", ",", "posi", ",", 
    RowBox[{"NS", "/", "2"}]}], "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8642525103765283`*^9, 3.864252604165722*^9}, {
  3.8642526447350073`*^9, 3.86425265969335*^9}, {3.864252947935561*^9, 
  3.8642529536547055`*^9}, {3.86425426295756*^9, 3.8642543297093*^9}, {
  3.872919635099105*^9, 3.87291966371762*^9}, {3.872920513802191*^9, 
  3.872920516133121*^9}, {3.895544962817142*^9, 3.8955449800090413`*^9}, {
  3.8955452449502697`*^9, 3.8955452523912587`*^9}, {3.89554531127862*^9, 
  3.8955453133579817`*^9}, {3.8955455442421865`*^9, 3.895545548253487*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"8e99c588-bfe3-47dc-91f7-9bca0d643a80"],

Cell[BoxData[
 RowBox[{"-", "1.7320508075688774`"}]], "Print",
 CellChangeTimes->{
  3.8955449838042283`*^9, 3.8955450493356447`*^9, 3.8955452534146566`*^9, 
   3.8955453140719013`*^9, 3.8955455488644094`*^9, 3.896838961695098*^9, 
   3.8989099771350985`*^9, 3.899284074469342*^9, 3.899284467034073*^9, 
   3.8992851678102837`*^9, 3.8993349785303164`*^9, {3.8993369142948313`*^9, 
   3.89933694120366*^9}},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[173]:=",ExpressionUUID->"bc0dc5d4-5b47-4179-\
a399-558a157882dd"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "2", "3", "4", "5", "6"},
     {"\<\"Sx\"\>", "0", "0", "0", "0", "0", "0"},
     {"\<\"Sy\"\>", "0", "0", "0", "0", "0", "0"},
     {"\<\"Sz\"\>", "0.07033118279643377`", 
      RowBox[{"-", "0.07033118279643372`"}], "0.07033118279643372`", 
      RowBox[{"-", "0.07033118279643369`"}], "0.07033118279643363`", 
      RowBox[{"-", "0.07033118279643374`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.89554498380722*^9, 3.8955450493376417`*^9, 3.8955452534166503`*^9, 
   3.895545314075605*^9, 3.8955455488674603`*^9, 3.896838961699115*^9, 
   3.89890997713809*^9, 3.8992840744752254`*^9, 3.8992844670389414`*^9, 
   3.8992851678178787`*^9, 3.8993349785375805`*^9, {3.8993369143026304`*^9, 
   3.8993369412102413`*^9}},
 CellLabel->
  "Out[177]//MatrixForm=",ExpressionUUID->"f1899250-2323-45b4-9c1f-\
d58aa095fce3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0102789`", ",", "0.9447430470314296`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.89554498380722*^9, 3.8955450493376417`*^9, 3.8955452534166503`*^9, 
   3.895545314075605*^9, 3.8955455488674603`*^9, 3.896838961699115*^9, 
   3.89890997713809*^9, 3.8992840744752254`*^9, 3.8992844670389414`*^9, 
   3.8992851678178787`*^9, 3.8993349785375805`*^9, {3.8993369143026304`*^9, 
   3.8993369412251334`*^9}},
 CellLabel->
  "Out[178]=",ExpressionUUID->"ca3e9469-3653-4c42-b47a-201ec1734ac9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrXYZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx_i\>\"", ",", "\"\<Sy_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sx_j\>\"", 
       ",", "\"\<Sy_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.895544599707526*^9, 3.8955447110168276`*^9}, {
   3.8955448571508827`*^9, 3.895544868650812*^9}, 3.895545276874895*^9, {
   3.8968389118836465`*^9, 3.8968389126453733`*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"b982cd8c-c61c-4f16-bd78-9e2638b20574"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 2}\"\>", "\<\"Sx_j\"\>", "\<\"Sy_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sx_i\"\>", "0", 
      RowBox[{"-", "0.06878741424621727`"}], "0"},
     {"\<\"Sy_i\"\>", "0.06878741424621727`", "0", "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.02387330870826816`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.895544992721786*^9, 3.895545053211773*^9, {3.8955452705677032`*^9, 
   3.8955452776480894`*^9}, 3.8955453181019073`*^9, 3.8955455517379026`*^9, 
   3.896838967321315*^9, 3.898909977975726*^9, 3.899284082889467*^9, 
   3.899284467070666*^9, 3.89928516785748*^9, 3.8993349785716367`*^9, {
   3.899336914368718*^9, 3.8993369412539234`*^9}},
 CellLabel->
  "Out[180]//MatrixForm=",ExpressionUUID->"7459d91d-02db-4b04-8d6e-\
6cd00669874d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrPMZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sp_i\>\"", ",", "\"\<Sm_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sp_j\>\"", 
       ",", "\"\<Sm_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.896838974069379*^9, 3.896838983723711*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"3773fa6f-aa1f-4021-a9bf-6ca8b0d100ab"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 2}\"\>", "\<\"Sp_j\"\>", "\<\"Sm_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sp_i\"\>", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.13757482849243452`", " ", "\[ImaginaryI]"}]}], "0"},
     {"\<\"Sm_i\"\>", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.13757482849243452`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.02387330870826816`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.896838991644908*^9, 3.8989099787749043`*^9, 3.8992840875067115`*^9, 
   3.899284467103622*^9, 3.899285167893589*^9, 3.8993349786075196`*^9, {
   3.8993369143999214`*^9, 3.8993369412870054`*^9}},
 CellLabel->
  "Out[182]//MatrixForm=",ExpressionUUID->"77914243-bbeb-405a-851f-\
b0f5b8335aa0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrXYZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx_i\>\"", ",", "\"\<Sy_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sx_j\>\"", 
       ",", "\"\<Sy_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.895545008053232*^9, 3.8955450086926546`*^9}, 
   3.8955452805425596`*^9, 3.896838921237594*^9},
 CellLabel->
  "In[183]:=",ExpressionUUID->"7057e4bf-e6f1-4efd-a651-f65b9568374b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={2, 1}\"\>", "\<\"Sx_j\"\>", "\<\"Sy_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sx_i\"\>", "0", "0.06878741424621727`", "0"},
     {"\<\"Sy_i\"\>", 
      RowBox[{"-", "0.06878741424621727`"}], "0", "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.02387330870826816`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8955450096033735`*^9, 3.895545056553382*^9, 3.895545281442421*^9, 
   3.895545321978763*^9, 3.895545552752858*^9, {3.8968389688310537`*^9, 
   3.896838993035163*^9}, 3.8989099796776237`*^9, 3.8992840902109833`*^9, 
   3.8992844671327305`*^9, 3.8992851679459887`*^9, 3.899334978664132*^9, {
   3.899336914435153*^9, 3.8993369413272505`*^9}},
 CellLabel->
  "Out[184]//MatrixForm=",ExpressionUUID->"bdf2162a-ef7c-46e5-8747-\
be3f96fb7e33"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrPMZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sp_i\>\"", ",", "\"\<Sm_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sp_j\>\"", 
       ",", "\"\<Sm_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.89683898900631*^9, 3.8968389905553703`*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"d255a988-1fd1-4c4f-b86b-ba38ac86d726"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={2, 1}\"\>", "\<\"Sp_j\"\>", "\<\"Sm_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sp_i\"\>", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.13757482849243452`", " ", "\[ImaginaryI]"}]}], "0"},
     {"\<\"Sm_i\"\>", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.13757482849243452`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.02387330870826816`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.896838994343642*^9, 3.8989099806001377`*^9, 3.8992840924810066`*^9, 
   3.899284467158677*^9, 3.8992851679804015`*^9, 3.8993349787027197`*^9, {
   3.8993369144715495`*^9, 3.8993369413791885`*^9}},
 CellLabel->
  "Out[186]//MatrixForm=",ExpressionUUID->"df25a92c-092e-4ade-ace3-\
274e0c9c3c43"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"hami", "[", 
    RowBox[{"(*", "Jx_", "*)"}], 
    RowBox[{"1.0", ",", 
     RowBox[{"(*", "Jy_", "*)"}], "0.8", ",", 
     RowBox[{"(*", "Jz_", "*)"}], "0.7", ",", 
     RowBox[{"(*", "Dx_", "*)"}], "0.2", ",", 
     RowBox[{"(*", "Dy_", "*)"}], "0.1", ",", 
     RowBox[{"(*", "Dz_", "*)"}], "5.0", ",", 
     RowBox[{"(*", "Hx_", "*)"}], "0.1", ",", 
     RowBox[{"(*", "Hy_", "*)"}], "0.1", ",", 
     RowBox[{"(*", "Hz_", "*)"}], "0.3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"mat", ",", "1", ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Arnoldi\>\"", ",", 
        RowBox[{"\"\<Shift\>\"", "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"Norm", "[", 
           RowBox[{"mat", ",", "2"}], "]"}]}]}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"val0", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"vec0", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "val0", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"GetMag", "[", 
           RowBox[{"vec0", ",", "posi", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NS"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx\>\"", ",", "\"\<Sy\>\"", ",", "\"\<Sz\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "NS"}], "}"}]}], "]"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetEE", "[", 
   RowBox[{"vec0", ",", "posi", ",", 
    RowBox[{"NS", "/", "2"}]}], "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8642525103765283`*^9, 3.864252604165722*^9}, {
  3.8642526447350073`*^9, 3.86425265969335*^9}, {3.864252947935561*^9, 
  3.8642529536547055`*^9}, {3.86425426295756*^9, 3.8642543297093*^9}, {
  3.872919635099105*^9, 3.87291966371762*^9}, {3.872920513802191*^9, 
  3.872920516133121*^9}, {3.895544962817142*^9, 3.8955449800090413`*^9}, {
  3.8955452449502697`*^9, 3.8955452523912587`*^9}, {3.89554531127862*^9, 
  3.8955453133579817`*^9}, {3.8955455442421865`*^9, 3.895545548253487*^9}, {
  3.896839025643938*^9, 3.8968390811172094`*^9}, {3.899335061893717*^9, 
  3.899335086496049*^9}, {3.8993351263786993`*^9, 3.8993351664753942`*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"b1e117ac-2bb3-454f-9aef-96ff63cc6b04"],

Cell[BoxData[
 RowBox[{"-", "10.051320288766092`"}]], "Print",
 CellChangeTimes->{{3.896839042579862*^9, 3.896839081967514*^9}, 
   3.8989099815038786`*^9, 3.899284096393608*^9, 3.8992844671884623`*^9, 
   3.8992851680218368`*^9, 3.899334978743132*^9, {3.899335101123016*^9, 
   3.899335167598432*^9}, {3.8993369145578337`*^9, 3.899336941431961*^9}},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[187]:=",ExpressionUUID->"ee82f400-35ad-4571-\
925a-8ec679eeddd7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "2", "3", "4", "5", "6"},
     {"\<\"Sx\"\>", "0.0017580437413824528`", "0.001758043741382478`", 
      "0.0017580437413824818`", "0.001758043741382451`", 
      "0.0017580437413824775`", "0.0017580437413824842`"},
     {"\<\"Sy\"\>", "0.0019069801479780508`", "0.0019069801479780686`", 
      "0.0019069801479780408`", "0.0019069801479780482`", 
      "0.001906980147978069`", "0.0019069801479780378`"},
     {"\<\"Sz\"\>", 
      RowBox[{"-", "0.00010847186468686959`"}], 
      RowBox[{"-", "0.00010847186468726511`"}], 
      RowBox[{"-", "0.00010847186468707082`"}], 
      RowBox[{"-", "0.00010847186468712633`"}], 
      RowBox[{"-", "0.0001084718646871749`"}], 
      RowBox[{"-", "0.00010847186468710551`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8968390425838485`*^9, 3.8968390819715033`*^9}, 
   3.898909981506869*^9, 3.8992840963994474`*^9, 3.8992844671953783`*^9, 
   3.899285168026703*^9, 3.899334978750983*^9, {3.8993351011316285`*^9, 
   3.899335167606219*^9}, {3.899336914566001*^9, 3.8993369414378014`*^9}},
 CellLabel->
  "Out[191]//MatrixForm=",ExpressionUUID->"c59ff15a-5c91-4ab5-9b01-\
8f3eb5e68fc4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0140612`", ",", "0.9532179315348874`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8968390425838485`*^9, 3.8968390819715033`*^9}, 
   3.898909981506869*^9, 3.8992840963994474`*^9, 3.8992844671953783`*^9, 
   3.899285168026703*^9, 3.899334978750983*^9, {3.8993351011316285`*^9, 
   3.899335167606219*^9}, {3.899336914566001*^9, 3.8993369414455132`*^9}},
 CellLabel->
  "Out[192]=",ExpressionUUID->"77b053a3-afcd-4906-b95a-a92063af6710"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NumberForm", "[", 
  RowBox[{"val0", ",", "10"}], "]"}]], "Input",
 CellChangeTimes->{{3.8993351795706873`*^9, 3.8993351936425657`*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"87f7a176-89c6-40f0-9e57-48b0998ecb01"],

Cell[BoxData[
 TagBox[
  InterpretationBox[
   StyleBox["\<\"-10.05132029\"\>",
    ShowStringCharacters->False],
   -10.051320288766092`,
   AutoDelete->True],
  NumberForm[#, 10]& ]], "Output",
 CellChangeTimes->{
  3.8993351950421057`*^9, {3.8993369146300983`*^9, 3.899336941474724*^9}},
 CellLabel->
  "Out[193]//NumberForm=",ExpressionUUID->"afb90e84-93e9-421e-8a8a-\
e9ee38da7ece"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrXYZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx_i\>\"", ",", "\"\<Sy_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sx_j\>\"", 
       ",", "\"\<Sy_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.895544599707526*^9, 3.8955447110168276`*^9}, {
   3.8955448571508827`*^9, 3.895544868650812*^9}, 3.895545276874895*^9, {
   3.8968389118836465`*^9, 3.8968389126453733`*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"9ca11734-96af-4cea-b7d9-3393e6c250a3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 2}\"\>", "\<\"Sx_j\"\>", "\<\"Sy_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sx_i\"\>", 
      RowBox[{"-", "0.08326215384564273`"}], 
      RowBox[{"-", "0.14398266179318356`"}], "0.0013761915112934036`"},
     {"\<\"Sy_i\"\>", "0.14393454180050164`", 
      RowBox[{"-", "0.08321375010454202`"}], 
      RowBox[{"-", "0.006484305995747817`"}]},
     {"\<\"Sz_i\"\>", 
      RowBox[{"-", "0.004293253752073942`"}], "0.0050997609229462525`", 
      RowBox[{"-", "0.11797593927196384`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8968391743787746`*^9, 3.8989099834198656`*^9, 3.899284106370335*^9, 
   3.899284467225255*^9, 3.8992851680578127`*^9, 3.899334978787548*^9, {
   3.8993369146630135`*^9, 3.899336941529219*^9}},
 CellLabel->
  "Out[195]//MatrixForm=",ExpressionUUID->"d2ee23b7-ef49-46eb-abd7-\
5bfe7472e08f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrPMZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sp_i\>\"", ",", "\"\<Sm_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sp_j\>\"", 
       ",", "\"\<Sm_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.896838974069379*^9, 3.896838983723711*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"e0a4ee7a-ffb8-4851-9113-45cf557fc3d1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 2}\"\>", "\<\"Sp_j\"\>", "\<\"Sm_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sp_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.000048403741100710304`"}], "-", 
       RowBox[{"0.0000481199926818983`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.16647590395018474`"}], "+", 
       RowBox[{"0.2879172035936852`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0013761915112934031`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.006484305995747815`", " ", "\[ImaginaryI]"}]}]},
     {"\<\"Sm_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.16647590395018474`"}], "-", 
       RowBox[{"0.2879172035936852`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.00004840374110071031`"}], "+", 
       RowBox[{"0.0000481199926818983`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0013761915112934036`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.006484305995747816`", " ", "\[ImaginaryI]"}]}]},
     {"\<\"Sz_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.004293253752073942`"}], "+", 
       RowBox[{"0.005099760922946253`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.004293253752073942`"}], "-", 
       RowBox[{"0.005099760922946253`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.11797593927196384`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.896839045686819*^9, 3.89683907451579*^9}, 
   3.898909984463487*^9, 3.8992841106742153`*^9, 3.8992844672522454`*^9, 
   3.8992851680905504`*^9, 3.8993349788270283`*^9, {3.899336914717944*^9, 
   3.8993369415596013`*^9}},
 CellLabel->
  "Out[197]//MatrixForm=",ExpressionUUID->"58f2fea3-f1d1-4df4-b0ef-\
3bce870bd598"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrPMZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sp_i\>\"", ",", "\"\<Sm_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sp_j\>\"", 
       ",", "\"\<Sm_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.896839096031066*^9, 3.896839103621807*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"4041ef98-c99a-44b6-a41f-8384c64df965"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={2, 1}\"\>", "\<\"Sp_j\"\>", "\<\"Sm_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sp_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.000048403741100710304`"}], "-", 
       RowBox[{"0.0000481199926818983`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.16647590395018474`"}], "-", 
       RowBox[{"0.2879172035936852`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.004293253752073942`"}], "+", 
       RowBox[{"0.005099760922946253`", " ", "\[ImaginaryI]"}]}]},
     {"\<\"Sm_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.16647590395018474`"}], "+", 
       RowBox[{"0.2879172035936852`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.00004840374110071031`"}], "+", 
       RowBox[{"0.0000481199926818983`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.004293253752073942`"}], "-", 
       RowBox[{"0.005099760922946253`", " ", "\[ImaginaryI]"}]}]},
     {"\<\"Sz_i\"\>", 
      RowBox[{"0.0013761915112934031`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.006484305995747815`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0013761915112934036`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.006484305995747816`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.11797593927196384`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.896839098243372*^9, 3.89683910472995*^9}, 
   3.8989099854456415`*^9, 3.8992841150709324`*^9, 3.899284467284277*^9, 
   3.899285168120119*^9, 3.8993349788629174`*^9, {3.899336914748227*^9, 
   3.8993369415967035`*^9}},
 CellLabel->
  "Out[199]//MatrixForm=",ExpressionUUID->"4246bc06-0959-4f43-9c79-\
a1fbd29dbd11"]
}, Open  ]]
},
WindowSize->{1031.641791044776, 576.5373134328358},
WindowMargins->{{
  1026.2686567164178`, Automatic}, {-4.8358208955223745`, Automatic}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
Magnification:>1.2 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (2022\:5e742\:67084\
\:65e5)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"4251c759-9591-480a-940c-a503d70a1c50"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2453, 72, 308, "Input",ExpressionUUID->"d1f9668e-5699-4eab-b05b-3a893d4f2097"],
Cell[3014, 94, 1604, 33, 153, "Input",ExpressionUUID->"eefab55a-d9f5-41d4-8c6b-d3c74d69dea7"],
Cell[4621, 129, 3015, 79, 274, "Input",ExpressionUUID->"695e3440-164c-4828-854a-67815aef1456"],
Cell[CellGroupData[{
Cell[7661, 212, 1552, 31, 122, "Input",ExpressionUUID->"86e637fc-830a-4417-8768-18c80ed3f109"],
Cell[9216, 245, 2162, 40, 61, "Output",ExpressionUUID->"acdf47df-1706-4cce-97a4-839f76d2ee37"],
Cell[11381, 287, 2161, 40, 61, "Output",ExpressionUUID->"932ef338-3fe2-4ce6-8a31-37e601bedcd4"]
}, Open  ]],
Cell[13557, 330, 9433, 207, 503, "Input",ExpressionUUID->"468dd902-6354-44f1-b520-9401842ecba0"],
Cell[22993, 539, 1002, 27, 62, "Input",ExpressionUUID->"3806b937-f7f0-46ac-afb7-0adb4b6bfaa1"],
Cell[23998, 568, 2847, 80, 173, "Input",ExpressionUUID->"55b2ec24-2297-4314-8f9a-234ed8abcf6c"],
Cell[26848, 650, 2748, 79, 173, "Input",ExpressionUUID->"69025ebf-6895-4ab0-bd8a-3745eace2945"],
Cell[29599, 731, 7665, 200, 1016, "Input",ExpressionUUID->"cbf716ff-aa25-4262-9080-7090d4d44064"],
Cell[CellGroupData[{
Cell[37289, 935, 2624, 72, 318, "Input",ExpressionUUID->"e41a7eed-97c1-419d-a9b4-f187d312d836"],
Cell[39916, 1009, 366, 8, 26, "Print",ExpressionUUID->"871b28b9-ae74-4456-848e-b603b8a7c39a"],
Cell[40285, 1019, 1353, 29, 120, "Output",ExpressionUUID->"c20032a4-9529-4073-993e-579d53e86505"],
Cell[41641, 1050, 796, 13, 61, "Output",ExpressionUUID->"4127343a-99f2-4412-8f64-10694757f1c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42474, 1068, 1188, 33, 145, "Input",ExpressionUUID->"b588ea67-15ba-4b1c-88c8-7865d0e48fc8"],
Cell[43665, 1103, 1205, 30, 123, "Output",ExpressionUUID->"9ce68193-5dd5-49ae-b8be-8ba643d44eac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44907, 1138, 1088, 31, 145, "Input",ExpressionUUID->"a601a36c-360f-4988-bd05-a1d8ef123964"],
Cell[45998, 1171, 1079, 28, 123, "Output",ExpressionUUID->"d8a71b7b-2289-40db-b5f3-f05a97015682"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47114, 1204, 2821, 74, 318, "Input",ExpressionUUID->"8e99c588-bfe3-47dc-91f7-9bca0d643a80"],
Cell[49938, 1280, 515, 10, 26, "Print",ExpressionUUID->"bc0dc5d4-5b47-4179-a399-558a157882dd"],
Cell[50456, 1292, 1263, 29, 120, "Output",ExpressionUUID->"f1899250-2323-45b4-9c1f-d58aa095fce3"],
Cell[51722, 1323, 526, 10, 61, "Output",ExpressionUUID->"ca3e9469-3653-4c42-b47a-201ec1734ac9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52285, 1338, 1217, 33, 145, "Input",ExpressionUUID->"b982cd8c-c61c-4f16-bd78-9e2638b20574"],
Cell[53505, 1373, 1203, 29, 123, "Output",ExpressionUUID->"7459d91d-02db-4b04-8d6e-6cd00669874d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54745, 1407, 1087, 31, 145, "Input",ExpressionUUID->"3773fa6f-aa1f-4021-a9bf-6ca8b0d100ab"],
Cell[55835, 1440, 1216, 30, 123, "Output",ExpressionUUID->"77914243-bbeb-405a-851f-b0f5b8335aa0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57088, 1475, 1139, 32, 145, "Input",ExpressionUUID->"7057e4bf-e6f1-4efd-a651-f65b9568374b"],
Cell[58230, 1509, 1206, 29, 123, "Output",ExpressionUUID->"bdf2162a-ef7c-46e5-8747-be3f96fb7e33"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59473, 1543, 1088, 31, 145, "Input",ExpressionUUID->"d255a988-1fd1-4c4f-b86b-ba38ac86d726"],
Cell[60564, 1576, 1218, 30, 123, "Output",ExpressionUUID->"df25a92c-092e-4ade-ace3-274e0c9c3c43"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61819, 1611, 2979, 76, 318, "Input",ExpressionUUID->"b1e117ac-2bb3-454f-9aef-96ff63cc6b04"],
Cell[64801, 1689, 459, 8, 26, "Print",ExpressionUUID->"ee82f400-35ad-4571-925a-8ec679eeddd7"],
Cell[65263, 1699, 1572, 34, 120, "Output",ExpressionUUID->"c59ff15a-5c91-4ab5-9b01-8f3eb5e68fc4"],
Cell[66838, 1735, 475, 8, 61, "Output",ExpressionUUID->"77b053a3-afcd-4906-b95a-a92063af6710"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67350, 1748, 243, 5, 79, "Input",ExpressionUUID->"87f7a176-89c6-40f0-9e57-48b0998ecb01"],
Cell[67596, 1755, 387, 12, 61, "Output",ExpressionUUID->"afb90e84-93e9-421e-8a8a-e9ee38da7ece"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68020, 1772, 1217, 33, 145, "Input",ExpressionUUID->"9ca11734-96af-4cea-b7d9-3393e6c250a3"],
Cell[69240, 1807, 1266, 31, 123, "Output",ExpressionUUID->"d2ee23b7-ef49-46eb-abd7-5bfe7472e08f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70543, 1843, 1087, 31, 145, "Input",ExpressionUUID->"e0a4ee7a-ffb8-4851-9113-45cf557fc3d1"],
Cell[71633, 1876, 2061, 48, 123, "Output",ExpressionUUID->"58f2fea3-f1d1-4df4-b0ef-3bce870bd598"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73731, 1929, 1087, 31, 145, "Input",ExpressionUUID->"4041ef98-c99a-44b6-a41f-8384c64df965"],
Cell[74821, 1962, 2059, 48, 123, "Output",ExpressionUUID->"4246bc06-0959-4f43-9c79-a1fbd29dbd11"]
}, Open  ]]
}
]
*)

