(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     83373,       2130]
NotebookOptionsPosition[     78379,       2044]
NotebookOutlinePosition[     78991,       2065]
CellTagsIndexPosition[     78948,       2062]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sz", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"Table", "[", 
      RowBox[{"ii", ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "SS", ",", 
         RowBox[{"-", "SS"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sp", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"SS", 
          RowBox[{"(", 
           RowBox[{"SS", "+", "1"}], ")"}]}], "-", 
         RowBox[{"jj", 
          RowBox[{"(", 
           RowBox[{"jj", "+", "1"}], ")"}]}]}]], 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"ii", ",", 
         RowBox[{"jj", "+", "1"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "SS", ",", 
        RowBox[{"-", "SS"}], ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "SS", ",", 
        RowBox[{"-", "SS"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sx", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"Sp", "+", 
      RowBox[{"Sp", "\[Transpose]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sy", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", "\[ImaginaryI]"}]], 
    RowBox[{"(", 
     RowBox[{"Sp", "-", 
      RowBox[{"Sp", "\[Transpose]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"II", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{
      RowBox[{"2", "SS"}], "+", "1"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8590126932424097`*^9, 3.8590128932112803`*^9}, {
   3.8590147128192883`*^9, 3.859014724028838*^9}, {3.8590147981878066`*^9, 
   3.8590148088017583`*^9}, {3.8590149071904373`*^9, 
   3.8590149074067397`*^9}, {3.8608462988447695`*^9, 3.8608463077173653`*^9}, 
   3.860846441572929*^9, {3.860847318732803*^9, 3.8608473279598017`*^9}, {
   3.8608473956579404`*^9, 3.8608474079702573`*^9}, {3.8716778381239443`*^9, 
   3.871677850384023*^9}, {3.895544404055787*^9, 3.8955444090858555`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"d1f9668e-5699-4eab-b05b-3a893d4f2097"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NS", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NODmin", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NODmax", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Szmax", "=", 
   RowBox[{
    RowBox[{"NS", "*", "SS"}], "-", "NODmin"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Szmin", "=", 
    RowBox[{
     RowBox[{"NS", "*", "SS"}], "-", "NODmax"}]}], ";"}], " "}]}], "Input",
 CellChangeTimes->{
  3.835748605111039*^9, {3.835748639232997*^9, 3.8357486466808863`*^9}, {
   3.846896778081738*^9, 3.8468967783292828`*^9}, {3.84690270158916*^9, 
   3.846902702122139*^9}, {3.8469027553996983`*^9, 3.8469027561551237`*^9}, {
   3.852533300621213*^9, 3.852533300757848*^9}, {3.8525359328591137`*^9, 
   3.8525359329527493`*^9}, 3.858827546065132*^9, {3.859011740655818*^9, 
   3.8590117715174522`*^9}, 3.8590118420963106`*^9, {3.8590148170312967`*^9, 
   3.859014866696488*^9}, {3.8650535165518136`*^9, 3.865053527019821*^9}, {
   3.872919072138908*^9, 3.872919082435092*^9}, {3.872919555982209*^9, 
   3.8729195870280137`*^9}, {3.894337669350979*^9, 3.89433767150371*^9}, {
   3.8955444126009626`*^9, 3.8955444166584373`*^9}, 3.8955450309256983`*^9, {
   3.8989098329309235`*^9, 3.8989098777175484`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"eefab55a-d9f5-41d4-8c6b-d3c74d69dea7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"mSx", "[", "nn", "]"}], "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "NS"}], "}"}]}], "]"}], ",", 
           RowBox[{"nn", "\[Rule]", "Sx"}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mSy", "[", "nn", "]"}], "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "NS"}], "}"}]}], "]"}], ",", 
           RowBox[{"nn", "\[Rule]", "Sy"}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mSp", "[", "nn", "]"}], "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "NS"}], "}"}]}], "]"}], ",", 
           RowBox[{"nn", "\[Rule]", "Sp"}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mSm", "[", "nn", "]"}], "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "NS"}], "}"}]}], "]"}], ",", 
           RowBox[{"nn", "\[Rule]", 
            RowBox[{"Sp", "\[Transpose]"}]}]}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mSz", "[", "nn", "]"}], "=", 
      RowBox[{"SparseArray", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"II", ",", 
             RowBox[{"{", 
              RowBox[{"jj", ",", "NS"}], "}"}]}], "]"}], ",", 
           RowBox[{"nn", "\[Rule]", "Sz"}]}], "]"}]}], "]"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"nn", ",", "1", ",", "NS", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.835748649302706*^9, 3.835748650532366*^9}, {
   3.84690209825313*^9, 3.846902099565158*^9}, {3.846904128746945*^9, 
   3.846904142986796*^9}, 3.85253511842143*^9, {3.8590118551704464`*^9, 
   3.8590118661995497`*^9}, {3.896838828581442*^9, 3.896838843718651*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"695e3440-164c-4828-854a-67815aef1456"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Jbonds", "=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "2", ",", "3", ",", "3", ",", "4", ",", "4", ",", 
      "5", ",", "5", ",", "6", ",", "6", ",", "1"}], "}"}], ",", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Dbonds", "=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "2", ",", "3", ",", "3", ",", "4", ",", "4", ",", 
      "5", ",", "5", ",", "6", ",", "6", ",", "1"}], "}"}], ",", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Gbonds", "=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "2", ",", "3", ",", "3", ",", "4", ",", "4", ",", 
      "5", ",", "5", ",", "6", ",", "6", ",", "1"}], "}"}], ",", "2"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8357486599603558`*^9, 3.835748670994281*^9}, {
   3.835749088559271*^9, 3.8357491645919*^9}, {3.846896799932757*^9, 
   3.846896834106448*^9}, {3.846896920569708*^9, 3.846897081504879*^9}, {
   3.852299097128045*^9, 3.8522991828429213`*^9}, {3.852299214768203*^9, 
   3.852299309150056*^9}, {3.8525333161540117`*^9, 3.852533451982788*^9}, {
   3.85253593929469*^9, 3.852535961527195*^9}, {3.852536004038513*^9, 
   3.852536064055562*^9}, {3.858827554924971*^9, 3.8588275630289865`*^9}, {
   3.85901187192725*^9, 3.8590118741542244`*^9}, {3.859014894056341*^9, 
   3.8590149004771647`*^9}, {3.865053533870576*^9, 3.8650535390189323`*^9}, {
   3.8729195973360806`*^9, 3.872919614327981*^9}, {3.872920056143998*^9, 
   3.872920057707058*^9}, {3.894337691561344*^9, 3.8943376941893806`*^9}, {
   3.8943378227453527`*^9, 3.894337823771959*^9}, {3.8955444292708526`*^9, 
   3.895544436398663*^9}, 3.899509020028533*^9},
 CellLabel->"In[67]:=",ExpressionUUID->"86e637fc-830a-4417-8768-18c80ed3f109"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.835749177213112*^9, 3.835751609937346*^9, 3.8360032225057573`*^9, 
   3.836005281024932*^9, 3.836008014496929*^9, 3.83600973694934*^9, 
   3.836011841702182*^9, 3.83601372087687*^9, 3.839593063242775*^9, 
   3.843165780684718*^9, 3.843182084320368*^9, 3.8437902686806107`*^9, 
   3.8437971291717987`*^9, 3.844211815954352*^9, 3.844230275774041*^9, 
   3.846896941973054*^9, {3.8468970561574163`*^9, 3.846897082925179*^9}, 
   3.8468974975199947`*^9, 3.8468977222678623`*^9, 3.846903734170856*^9, 
   3.847498809897109*^9, 3.848627119491132*^9, 3.8522991409096117`*^9, 
   3.8522991834402637`*^9, {3.852299284073073*^9, 3.852299313543104*^9}, 
   3.852303033106797*^9, 3.8523034015807333`*^9, 3.8525217210355773`*^9, 
   3.8525230941989717`*^9, 3.8525334787850513`*^9, 3.852536065740768*^9, 
   3.852537897177081*^9, 3.8525394890281763`*^9, 3.852539775238*^9, 
   3.8525399313468227`*^9, 3.8525404489747667`*^9, 3.853847015003517*^9, 
   3.856381825526411*^9, 3.8588275649866505`*^9, 3.859011930816147*^9, 
   3.859014910482568*^9, 3.859423136641081*^9, 3.8594231980213947`*^9, {
   3.8594233168689013`*^9, 3.859423351091732*^9}, 3.8594272714553223`*^9, 
   3.8642523935252695`*^9, 3.865053540478675*^9, 3.872919489993284*^9, 
   3.8729196154857426`*^9, {3.8729200403053093`*^9, 3.872920058880395*^9}, 
   3.894337696042715*^9, 3.8943378247847176`*^9, 3.8955444386798205`*^9, 
   3.8955450388388042`*^9, 3.895545229188249*^9, 3.8955470428599987`*^9, 
   3.896838852407874*^9, 3.8989098833437214`*^9, 3.899509079712324*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"59e4ef9b-8219-44dc-a012-041e37d90a91"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.835749177213112*^9, 3.835751609937346*^9, 3.8360032225057573`*^9, 
   3.836005281024932*^9, 3.836008014496929*^9, 3.83600973694934*^9, 
   3.836011841702182*^9, 3.83601372087687*^9, 3.839593063242775*^9, 
   3.843165780684718*^9, 3.843182084320368*^9, 3.8437902686806107`*^9, 
   3.8437971291717987`*^9, 3.844211815954352*^9, 3.844230275774041*^9, 
   3.846896941973054*^9, {3.8468970561574163`*^9, 3.846897082925179*^9}, 
   3.8468974975199947`*^9, 3.8468977222678623`*^9, 3.846903734170856*^9, 
   3.847498809897109*^9, 3.848627119491132*^9, 3.8522991409096117`*^9, 
   3.8522991834402637`*^9, {3.852299284073073*^9, 3.852299313543104*^9}, 
   3.852303033106797*^9, 3.8523034015807333`*^9, 3.8525217210355773`*^9, 
   3.8525230941989717`*^9, 3.8525334787850513`*^9, 3.852536065740768*^9, 
   3.852537897177081*^9, 3.8525394890281763`*^9, 3.852539775238*^9, 
   3.8525399313468227`*^9, 3.8525404489747667`*^9, 3.853847015003517*^9, 
   3.856381825526411*^9, 3.8588275649866505`*^9, 3.859011930816147*^9, 
   3.859014910482568*^9, 3.859423136641081*^9, 3.8594231980213947`*^9, {
   3.8594233168689013`*^9, 3.859423351091732*^9}, 3.8594272714553223`*^9, 
   3.8642523935252695`*^9, 3.865053540478675*^9, 3.872919489993284*^9, 
   3.8729196154857426`*^9, {3.8729200403053093`*^9, 3.872920058880395*^9}, 
   3.894337696042715*^9, 3.8943378247847176`*^9, 3.8955444386798205`*^9, 
   3.8955450388388042`*^9, 3.895545229188249*^9, 3.8955470428599987`*^9, 
   3.896838852407874*^9, 3.8989098833437214`*^9, 3.899509079715864*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"061a9a10-2675-4d92-9a17-d0634498dd4a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.835749177213112*^9, 3.835751609937346*^9, 3.8360032225057573`*^9, 
   3.836005281024932*^9, 3.836008014496929*^9, 3.83600973694934*^9, 
   3.836011841702182*^9, 3.83601372087687*^9, 3.839593063242775*^9, 
   3.843165780684718*^9, 3.843182084320368*^9, 3.8437902686806107`*^9, 
   3.8437971291717987`*^9, 3.844211815954352*^9, 3.844230275774041*^9, 
   3.846896941973054*^9, {3.8468970561574163`*^9, 3.846897082925179*^9}, 
   3.8468974975199947`*^9, 3.8468977222678623`*^9, 3.846903734170856*^9, 
   3.847498809897109*^9, 3.848627119491132*^9, 3.8522991409096117`*^9, 
   3.8522991834402637`*^9, {3.852299284073073*^9, 3.852299313543104*^9}, 
   3.852303033106797*^9, 3.8523034015807333`*^9, 3.8525217210355773`*^9, 
   3.8525230941989717`*^9, 3.8525334787850513`*^9, 3.852536065740768*^9, 
   3.852537897177081*^9, 3.8525394890281763`*^9, 3.852539775238*^9, 
   3.8525399313468227`*^9, 3.8525404489747667`*^9, 3.853847015003517*^9, 
   3.856381825526411*^9, 3.8588275649866505`*^9, 3.859011930816147*^9, 
   3.859014910482568*^9, 3.859423136641081*^9, 3.8594231980213947`*^9, {
   3.8594233168689013`*^9, 3.859423351091732*^9}, 3.8594272714553223`*^9, 
   3.8642523935252695`*^9, 3.865053540478675*^9, 3.872919489993284*^9, 
   3.8729196154857426`*^9, {3.8729200403053093`*^9, 3.872920058880395*^9}, 
   3.894337696042715*^9, 3.8943378247847176`*^9, 3.8955444386798205`*^9, 
   3.8955450388388042`*^9, 3.895545229188249*^9, 3.8955470428599987`*^9, 
   3.896838852407874*^9, 3.8989098833437214`*^9, 3.899509079716861*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"d160da88-792a-40f8-8c75-dea48c3958fc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hami", "[", 
    RowBox[{
    "Jx_", ",", "Jy_", ",", "Jz_", ",", "Dx_", ",", "Dy_", ",", "Dz_", ",", 
     "Gx_", ",", "Gy_", ",", "Gz_", ",", "Hx_", ",", "Hy_", ",", "Hz_"}], 
    "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"HAll", "=", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Jx", " ", 
             RowBox[{
              RowBox[{"mSx", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
              RowBox[{"mSx", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "+", 
            RowBox[{"Jy", " ", 
             RowBox[{
              RowBox[{"mSy", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
              RowBox[{"mSy", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], " ", "+", 
            RowBox[{"Jz", " ", 
             RowBox[{
              RowBox[{"mSz", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
              RowBox[{"mSz", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}], ")"}], "&"}], "/@",
          "Jbonds"}], "]"}], "+", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Dx", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}]}], "+", 
            RowBox[{"Dy", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}]}], " ", 
            "+", 
            RowBox[{"Dz", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}]}]}], ")"}],
           "&"}], "/@", "Dbonds"}], "]"}], "+", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Gx", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}]}], "+", 
            RowBox[{"Gy", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSz", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}]}], " ", 
            "+", 
            RowBox[{"Gz", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"mSy", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ".", 
                RowBox[{"mSx", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}]}]}], ")"}],
           "&"}], "/@", "Dbonds"}], "]"}], "-", 
       RowBox[{"Hx", " ", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mSx", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "NS", "]"}]}], "]"}]}], "-", 
       RowBox[{"Hy", " ", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mSy", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "NS", "]"}]}], "]"}]}], "-", 
       RowBox[{"Hz", " ", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mSz", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "NS", "]"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"When", " ", "U", 
       RowBox[{"(", "1", ")"}], " ", "is", " ", "preserved"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"posi", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Normal", "[", 
            RowBox[{"Diagonal", "[", 
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"mSz", "[", "#", "]"}], "&"}], "/@", 
               RowBox[{"Range", "[", "NS", "]"}]}], "]"}], "]"}], "]"}], ",", 
           
           RowBox[{"n_", " ", "/;", " ", 
            RowBox[{"n", "==", "SzMin"}]}]}], "]"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"When", " ", "U", 
       RowBox[{"(", "1", ")"}], " ", "is", " ", "not", " ", "preserved"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"posi", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"Diagonal", "[", 
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mSz", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", "NS", "]"}]}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"n_", " ", "/;", " ", 
          RowBox[{"Szmin", "<=", "n", "<=", "Szmax"}]}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"HAll", "[", 
      RowBox[{"[", 
       RowBox[{"posi", ",", "posi"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
    ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.835749236308423*^9, 3.835749259905862*^9}, {
   3.8357493015228033`*^9, 3.835749303802754*^9}, {3.835749354659789*^9, 
   3.835749380677432*^9}, 3.83575003357922*^9, {3.835750321347682*^9, 
   3.835750327923233*^9}, {3.8357505146508102`*^9, 3.835750522514373*^9}, 
   3.835750554553487*^9, {3.8357506131349487`*^9, 3.83575066032944*^9}, {
   3.8357508609895773`*^9, 3.8357509756212683`*^9}, {3.8357510104053793`*^9, 
   3.8357510731009073`*^9}, {3.83575111083736*^9, 3.835751236323717*^9}, {
   3.835751285236122*^9, 3.8357512853313627`*^9}, {3.8357513173800917`*^9, 
   3.835751343347898*^9}, {3.835751412843955*^9, 3.8357515505990763`*^9}, {
   3.835752087984779*^9, 3.8357520977107983`*^9}, 3.835752345270014*^9, {
   3.8357524113105173`*^9, 3.8357524128782167`*^9}, {3.835753832756716*^9, 
   3.8357538742880774`*^9}, {3.836004518178898*^9, 3.8360045491781807`*^9}, {
   3.836005912296547*^9, 3.836006039320539*^9}, {3.8360073943462963`*^9, 
   3.8360074596080837`*^9}, {3.836007573576137*^9, 3.836007655800295*^9}, {
   3.836007698641397*^9, 3.8360077426560297`*^9}, {3.836008185369494*^9, 
   3.836008201575471*^9}, {3.836010023935727*^9, 3.836010117668153*^9}, {
   3.836010583836747*^9, 3.836010587706355*^9}, 3.836010796443634*^9, {
   3.836010827497513*^9, 3.8360108562334337`*^9}, 3.83601090083339*^9, 
   3.8360118287432117`*^9, {3.836012643129567*^9, 3.8360126446043797`*^9}, 
   3.8360136601445093`*^9, {3.846897270947372*^9, 3.846897437409424*^9}, 
   3.846898298265911*^9, {3.8468986612065897`*^9, 3.846898679705593*^9}, {
   3.846902266696879*^9, 3.846902276328711*^9}, {3.846902306580574*^9, 
   3.846902315373189*^9}, 3.846902625885776*^9, {3.8469026558938828`*^9, 
   3.846902658847444*^9}, 3.846902693126952*^9, {3.846903141670808*^9, 
   3.846903243824995*^9}, {3.846903281778387*^9, 3.846903287119923*^9}, 
   3.8469038339750433`*^9, 3.846903888079928*^9, 3.846904017764452*^9, {
   3.846922820876429*^9, 3.8469228256335983`*^9}, {3.846923451552556*^9, 
   3.846923511041894*^9}, {3.846923556563575*^9, 3.84692357164128*^9}, {
   3.846924022930212*^9, 3.846924027593342*^9}, {3.8475025099343157`*^9, 
   3.847502527251458*^9}, {3.848627163557901*^9, 3.848627164147026*^9}, {
   3.852300810023588*^9, 3.852301006315295*^9}, {3.852301201619738*^9, 
   3.852301389073921*^9}, {3.8525335433227606`*^9, 3.852533873334607*^9}, {
   3.852533910943916*^9, 3.8525339439967775`*^9}, {3.8525361047666407`*^9, 
   3.8525361376579323`*^9}, {3.852536168029557*^9, 3.85253622041817*^9}, 
   3.852539764784671*^9, {3.8525408930113363`*^9, 3.85254091038559*^9}, {
   3.858827571779725*^9, 3.8588275774947457`*^9}, {3.858827622968748*^9, 
   3.858827693810526*^9}, {3.8590118848973217`*^9, 3.859012054359379*^9}, {
   3.8590149208349247`*^9, 3.8590149408004956`*^9}, {3.859014973728597*^9, 
   3.8590149986046*^9}, {3.859015186393597*^9, 3.8590152101988306`*^9}, {
   3.85901539062931*^9, 3.8590153963886814`*^9}, 3.8594274215746927`*^9, {
   3.864254178098172*^9, 3.8642541849106507`*^9}, {3.864254216026724*^9, 
   3.864254221263844*^9}, {3.864254775514139*^9, 3.8642547777497854`*^9}, {
   3.87291910138984*^9, 3.8729191626461115`*^9}, {3.895544447687689*^9, 
   3.8955444514722757`*^9}, {3.8989098881307836`*^9, 3.898909898557285*^9}, {
   3.8989099650228844`*^9, 3.898909965137184*^9}, {3.8995090286457443`*^9, 
   3.899509042054805*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"468dd902-6354-44f1-b520-9401842ecba0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetMag", "[", 
   RowBox[{"vec_", ",", "posi_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"vec", "\[Conjugate]"}], ".", "#", ".", "vec"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"mSx", "[", "i", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"mSy", "[", "i", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"mSz", "[", "i", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"posi", ",", "posi"}], "]"}], "]"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.864252409376627*^9, 3.8642524957199636`*^9}, {
   3.8642526275276723`*^9, 3.864252638742082*^9}, {3.8642544224381*^9, 
   3.86425443232662*^9}, {3.8642544640307865`*^9, 3.864254465854549*^9}, 
   3.8642545779334373`*^9},
 CellLabel->"In[71]:=",ExpressionUUID->"3806b937-f7f0-46ac-afb7-0adb4b6bfaa1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCorrXYZ", "[", 
   RowBox[{"vec_", ",", "posi_", ",", "i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vec", "\[Conjugate]"}], ".", "#", ".", "vec"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSx", "[", "i", "]"}], ".", 
          RowBox[{"mSx", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSx", "[", "i", "]"}], ".", 
          RowBox[{"mSy", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSx", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSy", "[", "i", "]"}], ".", 
          RowBox[{"mSx", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSy", "[", "i", "]"}], ".", 
          RowBox[{"mSy", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSy", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSx", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSy", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}]}], "}"}]}], ",", "3"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8955444986817694`*^9, 3.895544554822218*^9}, {
  3.8955447439604673`*^9, 3.895544780754654*^9}, {3.8955448284226255`*^9, 
  3.895544845008439*^9}, {3.8968388638951454`*^9, 3.896838864484391*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"55b2ec24-2297-4314-8f9a-234ed8abcf6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCorrPMZ", "[", 
   RowBox[{"vec_", ",", "posi_", ",", "i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"vec", "\[Conjugate]"}], ".", "#", ".", "vec"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSp", "[", "i", "]"}], ".", 
          RowBox[{"mSp", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSp", "[", "i", "]"}], ".", 
          RowBox[{"mSm", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSp", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSm", "[", "i", "]"}], ".", 
          RowBox[{"mSp", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSm", "[", "i", "]"}], ".", 
          RowBox[{"mSm", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSm", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSp", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSm", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSz", "[", "i", "]"}], ".", 
          RowBox[{"mSz", "[", "j", "]"}]}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"posi", ",", "posi"}], "]"}], "]"}]}], "}"}]}], ",", "3"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8968388118041677`*^9, 3.8968388207510448`*^9}, {
  3.896838860004522*^9, 3.896838887956397*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"69025ebf-6895-4ab0-bd8a-3745eace2945"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Entanglement", " ", "entropy", " ", "when", " ", "divided", " ", "into", 
     " ", "1"}], ",", "2", ",", "...", ",", 
    RowBox[{
     RowBox[{"l", " ", "and", " ", "l"}], "+", "1"}], ",", 
    RowBox[{"l", "+", "2"}], ",", ",", "...", ",", "NOS"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GetEE", "[", 
     RowBox[{"vec_", ",", "posi_", ",", "l_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Make", " ", "density", " ", "matrix"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rho", "=", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"vec", ",", 
          RowBox[{"vec", "\[Conjugate]"}]}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vec", "\[Conjugate]"}], ".", "vec"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Make", " ", "reduced", " ", "density", " ", "matrix", " ", "for", " ",
         "subsystem", " ", "A"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"listAB", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "l"}], "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"l", "+", "1"}], ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PadLeft", "[", 
            RowBox[{
             RowBox[{"IntegerDigits", "[", 
              RowBox[{
               RowBox[{"n", "-", "1"}], ",", 
               RowBox[{
                RowBox[{"2", "SS"}], "+", "1"}]}], "]"}], ",", "NS"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "SS"}], "+", "1"}], ")"}], "^", "NS"}]}], 
            "}"}]}], "]"}], "[", 
         RowBox[{"[", "posi", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"listA", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"listAB", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ruleA", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"listA", "->", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "listA", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"listB", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"listAB", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ruleB", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"listB", "->", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "listB", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"listABNum", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"listAB", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "/.", "ruleA"}], ",", 
          RowBox[{
           RowBox[{"listAB", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "/.", "ruleB"}]}], 
         "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rhoA", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"posiAi", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{"listABNum", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "_"}], "}"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"posiAj", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{"listABNum", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "_"}], "}"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"posiBi", "=", 
           RowBox[{"listABNum", "[", 
            RowBox[{"[", 
             RowBox[{"posiAi", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"posiBj", "=", 
           RowBox[{"listABNum", "[", 
            RowBox[{"[", 
             RowBox[{"posiAj", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"posiBi", "[", 
                RowBox[{"[", "m", "]"}], "]"}], "==", 
               RowBox[{"posiBj", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], ",", 
              RowBox[{"rho", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"posiAi", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], ",", 
                 RowBox[{"posiAj", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "]"}], ",", "0"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", 
              RowBox[{"Length", "[", "posiAi", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"Length", "[", "posiAj", "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "listA", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "listA", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Calculate", " ", "vN", " ", "entropy", " ", "of", " ", "rhoA"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]val0", "=", 
       RowBox[{"Eigenvalues", "[", "rhoA", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]val", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"\[Lambda]val0", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", "#", "]"}], ">", 
           RowBox[{"10", "^", 
            RowBox[{"-", "12"}]}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SA", "=", 
       RowBox[{"-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Lambda]val", "[", 
            RowBox[{"[", "i", "]"}], "]"}], 
           RowBox[{"Log", "[", 
            RowBox[{"\[Lambda]val", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "\[Lambda]val", "]"}]}], "}"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "SA"}], "\[IndentingNewLine]",
      ")"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8729191972377768`*^9, 3.8729192767936335`*^9}, {
   3.872919320206108*^9, 3.872919345327308*^9}, {3.872919379117259*^9, 
   3.872919420690125*^9}, {3.8729194515639973`*^9, 3.872919479388748*^9}, {
   3.8729198377876964`*^9, 3.8729198462977285`*^9}, 3.8729198868614063`*^9, 
   3.872920249031021*^9, {3.872929330240371*^9, 3.87292935496992*^9}, {
   3.872931520318635*^9, 3.8729315360741777`*^9}, 3.8729324099110975`*^9},
 CellLabel->"In[74]:=",ExpressionUUID->"cbf716ff-aa25-4262-9080-7090d4d44064"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"hami", "[", 
    RowBox[{"(*", "Jx_", "*)"}], 
    RowBox[{"1.0", ",", 
     RowBox[{"(*", "Jy_", "*)"}], "1.0", ",", 
     RowBox[{"(*", "Jz_", "*)"}], "1.0", ",", 
     RowBox[{"(*", "Dx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Dy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Dz_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Gx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Gy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Gz_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hz_", "*)"}], "0."}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"mat", ",", "1", ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Arnoldi\>\"", ",", 
        RowBox[{"\"\<Shift\>\"", "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"Norm", "[", 
           RowBox[{"mat", ",", "2"}], "]"}]}]}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"val0", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"vec0", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "val0", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"GetMag", "[", 
           RowBox[{"vec0", ",", "posi", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NS"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx\>\"", ",", "\"\<Sy\>\"", ",", "\"\<Sz\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "NS"}], "}"}]}], "]"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetEE", "[", 
   RowBox[{"vec0", ",", "posi", ",", 
    RowBox[{"NS", "/", "2"}]}], "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8642525103765283`*^9, 3.864252604165722*^9}, {
   3.8642526447350073`*^9, 3.86425265969335*^9}, {3.864252947935561*^9, 
   3.8642529536547055`*^9}, {3.86425426295756*^9, 3.8642543297093*^9}, {
   3.872919635099105*^9, 3.87291966371762*^9}, {3.872920513802191*^9, 
   3.872920516133121*^9}, 3.899509057156664*^9},
 CellLabel->"In[75]:=",ExpressionUUID->"e41a7eed-97c1-419d-a9b4-f187d312d836"],

Cell[BoxData[
 RowBox[{"-", "2.8027756377319943`"}]], "Print",
 CellChangeTimes->{3.898909973771023*^9, 3.8995090848159933`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[75]:=",ExpressionUUID->"27a9afe6-5862-4d05-ab7a-\
b62c22d68ea0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "2", "3", "4", "5", "6"},
     {"\<\"Sx\"\>", "0", "0", "0", "0", "0", "0"},
     {"\<\"Sy\"\>", "0", "0", "0", "0", "0", "0"},
     {"\<\"Sz\"\>", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.864252606529915*^9, {3.8642526486543407`*^9, 3.8642526603173027`*^9}, 
   3.864252954783156*^9, 3.864254265914912*^9, 3.864254299172228*^9, 
   3.8642543300284953`*^9, 3.8642547940236826`*^9, 3.872920228555212*^9, 
   3.8729203256008043`*^9, 3.872920583919051*^9, 3.894337725305843*^9, 
   3.8955447141454706`*^9, 3.8955447846488953`*^9, 3.8955450454236436`*^9, 
   3.8968388977555027`*^9, 3.8989099257935057`*^9, 3.898909973785987*^9, 
   3.8995090848289967`*^9},
 CellLabel->
  "Out[79]//MatrixForm=",ExpressionUUID->"87a40ef7-1664-41d2-82ee-\
0e1b9f824f58"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0094398`", ",", "0.9590063760890905`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.864252606529915*^9, {3.8642526486543407`*^9, 3.8642526603173027`*^9}, 
   3.864252954783156*^9, 3.864254265914912*^9, 3.864254299172228*^9, 
   3.8642543300284953`*^9, 3.8642547940236826`*^9, 3.872920228555212*^9, 
   3.8729203256008043`*^9, 3.872920583919051*^9, 3.894337725305843*^9, 
   3.8955447141454706`*^9, 3.8955447846488953`*^9, 3.8955450454236436`*^9, 
   3.8968388977555027`*^9, 3.8989099257935057`*^9, 3.898909973785987*^9, 
   3.899509084836977*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"0f76b7cc-39cc-4fb6-bc35-a999cfa4008c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrXYZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx_i\>\"", ",", "\"\<Sy_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sx_j\>\"", 
       ",", "\"\<Sy_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.895544599707526*^9, 3.8955447110168276`*^9}, {
  3.8955448571508827`*^9, 3.895544868650812*^9}, {3.89683890226023*^9, 
  3.896838903012211*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"b588ea67-15ba-4b1c-88c8-7865d0e48fc8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 4}\"\>", "\<\"Sx_j\"\>", "\<\"Sy_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sx_i\"\>", 
      RowBox[{"-", "0.07725553375275233`"}], "0", "0"},
     {"\<\"Sy_i\"\>", "0", 
      RowBox[{"-", "0.07725553375275233`"}], "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.07725553375275233`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8955447196727743`*^9, 3.8955447857254744`*^9, {3.89554485008597*^9, 
   3.8955448691965365`*^9}, 3.8955450480871487`*^9, 3.8968389381455054`*^9, 
   3.898909975255781*^9, 3.8995090860667076`*^9},
 CellLabel->
  "Out[82]//MatrixForm=",ExpressionUUID->"77525e30-06b9-4096-b01e-\
16be4bcf7a55"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrPMZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sp_i\>\"", ",", "\"\<Sm_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sp_j\>\"", 
       ",", "\"\<Sm_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8968389446443443`*^9, 3.89683895358187*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"a601a36c-360f-4988-bd05-a1d8ef123964"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 4}\"\>", "\<\"Sp_j\"\>", "\<\"Sm_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sp_i\"\>", "0", 
      RowBox[{"-", "0.15451106750550467`"}], "0"},
     {"\<\"Sm_i\"\>", 
      RowBox[{"-", "0.15451106750550467`"}], "0", "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.07725553375275233`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.896838954597859*^9, 3.89890997609414*^9, 
  3.8995090869101453`*^9},
 CellLabel->
  "Out[84]//MatrixForm=",ExpressionUUID->"c5d778fb-508e-45f3-8d09-\
1ed072cba3fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"hami", "[", 
    RowBox[{"(*", "Jx_", "*)"}], 
    RowBox[{"0.0", ",", 
     RowBox[{"(*", "Jy_", "*)"}], "0.0", ",", 
     RowBox[{"(*", "Jz_", "*)"}], "0.0", ",", 
     RowBox[{"(*", "Dx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Dy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Dz_", "*)"}], "1", ",", 
     RowBox[{"(*", "Gx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Gy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Gz_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hx_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hy_", "*)"}], "0.", ",", 
     RowBox[{"(*", "Hz_", "*)"}], "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"mat", ",", "1", ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Arnoldi\>\"", ",", 
        RowBox[{"\"\<Shift\>\"", "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"Norm", "[", 
           RowBox[{"mat", ",", "2"}], "]"}]}]}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"val0", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"vec0", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "val0", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"GetMag", "[", 
           RowBox[{"vec0", ",", "posi", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NS"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx\>\"", ",", "\"\<Sy\>\"", ",", "\"\<Sz\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "NS"}], "}"}]}], "]"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetEE", "[", 
   RowBox[{"vec0", ",", "posi", ",", 
    RowBox[{"NS", "/", "2"}]}], "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8642525103765283`*^9, 3.864252604165722*^9}, {
   3.8642526447350073`*^9, 3.86425265969335*^9}, {3.864252947935561*^9, 
   3.8642529536547055`*^9}, {3.86425426295756*^9, 3.8642543297093*^9}, {
   3.872919635099105*^9, 3.87291966371762*^9}, {3.872920513802191*^9, 
   3.872920516133121*^9}, {3.895544962817142*^9, 3.8955449800090413`*^9}, {
   3.8955452449502697`*^9, 3.8955452523912587`*^9}, {3.89554531127862*^9, 
   3.8955453133579817`*^9}, {3.8955455442421865`*^9, 3.895545548253487*^9}, 
   3.899509064568182*^9},
 CellLabel->"In[85]:=",ExpressionUUID->"8e99c588-bfe3-47dc-91f7-9bca0d643a80"],

Cell[BoxData[
 RowBox[{"-", "1.7320508075688774`"}]], "Print",
 CellChangeTimes->{3.8955449838042283`*^9, 3.8955450493356447`*^9, 
  3.8955452534146566`*^9, 3.8955453140719013`*^9, 3.8955455488644094`*^9, 
  3.896838961695098*^9, 3.8989099771350985`*^9, 3.899509087732257*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[85]:=",ExpressionUUID->"40c173ce-2cc9-4e85-a74b-\
742a6ed5eadc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "2", "3", "4", "5", "6"},
     {"\<\"Sx\"\>", "0", "0", "0", "0", "0", "0"},
     {"\<\"Sy\"\>", "0", "0", "0", "0", "0", "0"},
     {"\<\"Sz\"\>", 
      RowBox[{"-", "0.12659761069275444`"}], "0.1265976106927544`", 
      RowBox[{"-", "0.1265976106927544`"}], "0.12659761069275433`", 
      RowBox[{"-", "0.12659761069275435`"}], "0.1265976106927545`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.89554498380722*^9, 3.8955450493376417`*^9, 
  3.8955452534166503`*^9, 3.895545314075605*^9, 3.8955455488674603`*^9, 
  3.896838961699115*^9, 3.89890997713809*^9, 3.899509087736247*^9},
 CellLabel->
  "Out[89]//MatrixForm=",ExpressionUUID->"1e58ff74-77f9-49b1-817f-\
2f7111f251d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0097925`", ",", "0.9257111992752067`"}], "}"}]], "Output",
 CellChangeTimes->{3.89554498380722*^9, 3.8955450493376417`*^9, 
  3.8955452534166503`*^9, 3.895545314075605*^9, 3.8955455488674603`*^9, 
  3.896838961699115*^9, 3.89890997713809*^9, 3.8995090877402596`*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"9a7566e9-ccc9-496a-a317-9c93601bb02d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrXYZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx_i\>\"", ",", "\"\<Sy_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sx_j\>\"", 
       ",", "\"\<Sy_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.895544599707526*^9, 3.8955447110168276`*^9}, {
   3.8955448571508827`*^9, 3.895544868650812*^9}, 3.895545276874895*^9, {
   3.8968389118836465`*^9, 3.8968389126453733`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"b982cd8c-c61c-4f16-bd78-9e2638b20574"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 2}\"\>", "\<\"Sx_j\"\>", "\<\"Sy_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sx_i\"\>", "0", 
      RowBox[{"-", "0.0901369613398538`"}], "0"},
     {"\<\"Sy_i\"\>", "0.0901369613398538`", "0", "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.0485256422314434`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.895544992721786*^9, 3.895545053211773*^9, {3.8955452705677032`*^9, 
   3.8955452776480894`*^9}, 3.8955453181019073`*^9, 3.8955455517379026`*^9, 
   3.896838967321315*^9, 3.898909977975726*^9, 3.899509088785953*^9},
 CellLabel->
  "Out[92]//MatrixForm=",ExpressionUUID->"5a331bee-e583-4cfd-a544-\
108ee37d71f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrPMZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sp_i\>\"", ",", "\"\<Sm_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sp_j\>\"", 
       ",", "\"\<Sm_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.896838974069379*^9, 3.896838983723711*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"3773fa6f-aa1f-4021-a9bf-6ca8b0d100ab"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 2}\"\>", "\<\"Sp_j\"\>", "\<\"Sm_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sp_i\"\>", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.1802739226797076`", " ", "\[ImaginaryI]"}]}], "0"},
     {"\<\"Sm_i\"\>", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.1802739226797076`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.0485256422314434`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.896838991644908*^9, 3.8989099787749043`*^9, 
  3.899509089606762*^9},
 CellLabel->
  "Out[94]//MatrixForm=",ExpressionUUID->"289fc8ee-3285-40e0-b76a-\
7bfa3ddef2fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrXYZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx_i\>\"", ",", "\"\<Sy_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sx_j\>\"", 
       ",", "\"\<Sy_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.895545008053232*^9, 3.8955450086926546`*^9}, 
   3.8955452805425596`*^9, 3.896838921237594*^9},
 CellLabel->"In[95]:=",ExpressionUUID->"7057e4bf-e6f1-4efd-a651-f65b9568374b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={2, 1}\"\>", "\<\"Sx_j\"\>", "\<\"Sy_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sx_i\"\>", "0", "0.0901369613398538`", "0"},
     {"\<\"Sy_i\"\>", 
      RowBox[{"-", "0.0901369613398538`"}], "0", "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.0485256422314434`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8955450096033735`*^9, 3.895545056553382*^9, 3.895545281442421*^9, 
   3.895545321978763*^9, 3.895545552752858*^9, {3.8968389688310537`*^9, 
   3.896838993035163*^9}, 3.8989099796776237`*^9, 3.89950909045603*^9},
 CellLabel->
  "Out[96]//MatrixForm=",ExpressionUUID->"27396a1c-e746-4cc3-917a-\
3615c71d5226"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrPMZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sp_i\>\"", ",", "\"\<Sm_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sp_j\>\"", 
       ",", "\"\<Sm_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.89683898900631*^9, 3.8968389905553703`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"d255a988-1fd1-4c4f-b86b-ba38ac86d726"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={2, 1}\"\>", "\<\"Sp_j\"\>", "\<\"Sm_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sp_i\"\>", "0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.1802739226797076`", " ", "\[ImaginaryI]"}]}], "0"},
     {"\<\"Sm_i\"\>", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.1802739226797076`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {"\<\"Sz_i\"\>", "0", "0", 
      RowBox[{"-", "0.0485256422314434`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.896838994343642*^9, 3.8989099806001377`*^9, 
  3.899509091301215*^9},
 CellLabel->
  "Out[98]//MatrixForm=",ExpressionUUID->"2fc6ecd8-6f38-4812-899f-\
a23d086f24b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"hami", "[", 
    RowBox[{"(*", "Jx_", "*)"}], 
    RowBox[{"1.0", ",", 
     RowBox[{"(*", "Jy_", "*)"}], "0.8", ",", 
     RowBox[{"(*", "Jz_", "*)"}], "0.7", ",", 
     RowBox[{"(*", "Dx_", "*)"}], "0.2", ",", 
     RowBox[{"(*", "Dy_", "*)"}], "0.1", ",", 
     RowBox[{"(*", "Dz_", "*)"}], "5.0", ",", 
     RowBox[{"(*", "Gx_", "*)"}], "0.1", ",", 
     RowBox[{"(*", "Gy_", "*)"}], "0.3", ",", 
     RowBox[{"(*", "Gz_", "*)"}], 
     RowBox[{"-", "0.2"}], ",", 
     RowBox[{"(*", "Hx_", "*)"}], "0.1", ",", 
     RowBox[{"(*", "Hy_", "*)"}], "0.1", ",", 
     RowBox[{"(*", "Hz_", "*)"}], "0.3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"mat", ",", "1", ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Arnoldi\>\"", ",", 
        RowBox[{"\"\<Shift\>\"", "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"Norm", "[", 
           RowBox[{"mat", ",", "2"}], "]"}]}]}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"val0", ",", "vec0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"val0", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"vec0", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "val0", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"GetMag", "[", 
           RowBox[{"vec0", ",", "posi", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NS"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx\>\"", ",", "\"\<Sy\>\"", ",", "\"\<Sz\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "NS"}], "}"}]}], "]"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetEE", "[", 
   RowBox[{"vec0", ",", "posi", ",", 
    RowBox[{"NS", "/", "2"}]}], "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8642525103765283`*^9, 3.864252604165722*^9}, {
   3.8642526447350073`*^9, 3.86425265969335*^9}, {3.864252947935561*^9, 
   3.8642529536547055`*^9}, {3.86425426295756*^9, 3.8642543297093*^9}, {
   3.872919635099105*^9, 3.87291966371762*^9}, {3.872920513802191*^9, 
   3.872920516133121*^9}, {3.895544962817142*^9, 3.8955449800090413`*^9}, {
   3.8955452449502697`*^9, 3.8955452523912587`*^9}, {3.89554531127862*^9, 
   3.8955453133579817`*^9}, {3.8955455442421865`*^9, 3.895545548253487*^9}, {
   3.896839025643938*^9, 3.8968390811172094`*^9}, 3.8995090730951624`*^9},
 CellLabel->"In[99]:=",ExpressionUUID->"b1e117ac-2bb3-454f-9aef-96ff63cc6b04"],

Cell[BoxData[
 RowBox[{"-", "10.061310078974763`"}]], "Print",
 CellChangeTimes->{{3.896839042579862*^9, 3.896839081967514*^9}, 
   3.8989099815038786`*^9, 3.899509092222125*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[99]:=",ExpressionUUID->"94d28b83-7de9-405c-9054-\
d53a7cecc65e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "2", "3", "4", "5", "6"},
     {"\<\"Sx\"\>", "0.001672989926265541`", "0.0016729899262655466`", 
      "0.0016729899262655581`", "0.0016729899262655325`", 
      "0.0016729899262655503`", "0.0016729899262655536`"},
     {"\<\"Sy\"\>", "0.0018939392894267411`", "0.0018939392894267567`", 
      "0.0018939392894267405`", "0.001893939289426745`", 
      "0.0018939392894267524`", "0.0018939392894267333`"},
     {"\<\"Sz\"\>", 
      RowBox[{"-", "0.00014056017543243038`"}], 
      RowBox[{"-", "0.000140560175432531`"}], 
      RowBox[{"-", "0.00014056017543248242`"}], 
      RowBox[{"-", "0.0001405601754326559`"}], 
      RowBox[{"-", "0.0001405601754325414`"}], 
      RowBox[{"-", "0.00014056017543256916`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8968390425838485`*^9, 3.8968390819715033`*^9}, 
   3.898909981506869*^9, 3.8995090922286186`*^9},
 CellLabel->
  "Out[103]//MatrixForm=",ExpressionUUID->"fe8ea866-c068-4d68-979f-\
fa1635da7dee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.006461`", ",", "0.9536062666664766`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8968390425838485`*^9, 3.8968390819715033`*^9}, 
   3.898909981506869*^9, 3.8995090922316256`*^9},
 CellLabel->
  "Out[104]=",ExpressionUUID->"09e86859-3f3b-4bd8-be94-b9def9b35e08"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrXYZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sx_i\>\"", ",", "\"\<Sy_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sx_j\>\"", 
       ",", "\"\<Sy_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.895544599707526*^9, 3.8955447110168276`*^9}, {
   3.8955448571508827`*^9, 3.895544868650812*^9}, 3.895545276874895*^9, {
   3.8968389118836465`*^9, 3.8968389126453733`*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"9ca11734-96af-4cea-b7d9-3393e6c250a3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 2}\"\>", "\<\"Sx_j\"\>", "\<\"Sy_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sx_i\"\>", 
      RowBox[{"-", "0.08345774097451673`"}], 
      RowBox[{"-", "0.14387576708147748`"}], 
      RowBox[{"-", "0.00012027409037654747`"}]},
     {"\<\"Sy_i\"\>", "0.1436633770743282`", 
      RowBox[{"-", "0.0831871173561883`"}], 
      RowBox[{"-", "0.009204362410119965`"}]},
     {"\<\"Sz_i\"\>", 
      RowBox[{"-", "0.006909212608663673`"}], "0.0066713347521368815`", 
      RowBox[{"-", "0.11813375513809249`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8968391743787746`*^9, 3.8989099834198656`*^9, 
  3.899509093491645*^9},
 CellLabel->
  "Out[106]//MatrixForm=",ExpressionUUID->"cadc2088-dd2c-4bc5-8138-\
b86e3c4bc74e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrPMZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sp_i\>\"", ",", "\"\<Sm_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sp_j\>\"", 
       ",", "\"\<Sm_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.896838974069379*^9, 3.896838983723711*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"e0a4ee7a-ffb8-4851-9113-45cf557fc3d1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={1, 2}\"\>", "\<\"Sp_j\"\>", "\<\"Sm_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sp_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.00027062361832844785`"}], "-", 
       RowBox[{"0.00021239000714929623`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.16664485833070503`"}], "+", 
       RowBox[{"0.2875391441558056`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0001202740903765479`"}], "-", 
       RowBox[{"0.009204362410119965`", " ", "\[ImaginaryI]"}]}]},
     {"\<\"Sm_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.16664485833070503`"}], "-", 
       RowBox[{"0.2875391441558056`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.00027062361832844785`"}], "+", 
       RowBox[{"0.00021239000714929623`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0001202740903765479`"}], "+", 
       RowBox[{"0.009204362410119965`", " ", "\[ImaginaryI]"}]}]},
     {"\<\"Sz_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.006909212608663673`"}], "+", 
       RowBox[{"0.006671334752136882`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.006909212608663673`"}], "-", 
       RowBox[{"0.006671334752136882`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.11813375513809249`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.896839045686819*^9, 3.89683907451579*^9}, 
   3.898909984463487*^9, 3.899509094575153*^9},
 CellLabel->
  "Out[108]//MatrixForm=",ExpressionUUID->"a1dc4f44-5ef7-4ed6-8857-\
20a6f649f60a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i0", ",", "j0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetCorrPMZ", "[", 
          RowBox[{"vec0", ",", "posi", ",", "i0", ",", "j0"}], "]"}], 
         "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sp_i\>\"", ",", "\"\<Sm_i\>\"", ",", "\"\<Sz_i\>\""}], 
         "}"}]}], "]"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<{i,j}=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"{", 
          RowBox[{"i0", ",", "j0"}], "}"}], "]"}]}], ",", "\"\<Sp_j\>\"", 
       ",", "\"\<Sm_j\>\"", ",", "\"\<Sz_j\>\""}], "}"}]}], "]"}], "//", 
   "Chop"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.896839096031066*^9, 3.896839103621807*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"4041ef98-c99a-44b6-a41f-8384c64df965"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"{i,j}={2, 1}\"\>", "\<\"Sp_j\"\>", "\<\"Sm_j\"\>", \
"\<\"Sz_j\"\>"},
     {"\<\"Sp_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.00027062361832844785`"}], "-", 
       RowBox[{"0.00021239000714929623`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.16664485833070503`"}], "-", 
       RowBox[{"0.2875391441558056`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.006909212608663673`"}], "+", 
       RowBox[{"0.006671334752136882`", " ", "\[ImaginaryI]"}]}]},
     {"\<\"Sm_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.16664485833070503`"}], "+", 
       RowBox[{"0.2875391441558056`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.00027062361832844785`"}], "+", 
       RowBox[{"0.00021239000714929623`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.006909212608663673`"}], "-", 
       RowBox[{"0.006671334752136882`", " ", "\[ImaginaryI]"}]}]},
     {"\<\"Sz_i\"\>", 
      RowBox[{
       RowBox[{"-", "0.0001202740903765479`"}], "-", 
       RowBox[{"0.009204362410119965`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0001202740903765479`"}], "+", 
       RowBox[{"0.009204362410119965`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.11813375513809249`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.896839098243372*^9, 3.89683910472995*^9}, 
   3.8989099854456415`*^9, 3.8995090956569586`*^9},
 CellLabel->
  "Out[110]//MatrixForm=",ExpressionUUID->"4e52a6fb-d34a-4610-b9e8-\
43ea5edaa61b"]
}, Open  ]]
},
WindowSize->{1428., 729.75},
WindowMargins->{{1440, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
Magnification:>1.2 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (2022\:5e742\:67084\
\:65e5)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"356e8231-ec64-4b63-8eba-64069d941c02"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2449, 71, 267, "Input",ExpressionUUID->"d1f9668e-5699-4eab-b05b-3a893d4f2097"],
Cell[3010, 93, 1400, 29, 139, "Input",ExpressionUUID->"eefab55a-d9f5-41d4-8c6b-d3c74d69dea7"],
Cell[4413, 124, 3011, 78, 260, "Input",ExpressionUUID->"695e3440-164c-4828-854a-67815aef1456"],
Cell[CellGroupData[{
Cell[7449, 206, 1865, 38, 149, "Input",ExpressionUUID->"86e637fc-830a-4417-8768-18c80ed3f109"],
Cell[9317, 246, 2032, 37, 61, "Output",ExpressionUUID->"59e4ef9b-8219-44dc-a012-041e37d90a91"],
Cell[11352, 285, 2032, 37, 61, "Output",ExpressionUUID->"061a9a10-2675-4d92-9a17-d0634498dd4a"],
Cell[13387, 324, 2032, 37, 61, "Output",ExpressionUUID->"d160da88-792a-40f8-8c75-dea48c3958fc"]
}, Open  ]],
Cell[15434, 364, 11768, 266, 554, "Input",ExpressionUUID->"468dd902-6354-44f1-b520-9401842ecba0"],
Cell[27205, 632, 998, 26, 48, "Input",ExpressionUUID->"3806b937-f7f0-46ac-afb7-0adb4b6bfaa1"],
Cell[28206, 660, 2843, 79, 136, "Input",ExpressionUUID->"55b2ec24-2297-4314-8f9a-234ed8abcf6c"],
Cell[31052, 741, 2744, 78, 136, "Input",ExpressionUUID->"69025ebf-6895-4ab0-bd8a-3745eace2945"],
Cell[33799, 821, 7661, 199, 936, "Input",ExpressionUUID->"cbf716ff-aa25-4262-9080-7090d4d44064"],
Cell[CellGroupData[{
Cell[41485, 1024, 2784, 74, 261, "Input",ExpressionUUID->"e41a7eed-97c1-419d-a9b4-f187d312d836"],
Cell[44272, 1100, 236, 5, 26, "Print",ExpressionUUID->"27a9afe6-5862-4d05-ab7a-b62c22d68ea0"],
Cell[44511, 1107, 1228, 28, 120, "Output",ExpressionUUID->"87a40ef7-1664-41d2-82ee-0e1b9f824f58"],
Cell[45742, 1137, 666, 11, 61, "Output",ExpressionUUID->"0f76b7cc-39cc-4fb6-bc35-a999cfa4008c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46445, 1153, 1184, 32, 130, "Input",ExpressionUUID->"b588ea67-15ba-4b1c-88c8-7865d0e48fc8"],
Cell[47632, 1187, 1082, 28, 123, "Output",ExpressionUUID->"77525e30-06b9-4096-b01e-16be4bcf7a55"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48751, 1220, 1084, 30, 130, "Input",ExpressionUUID->"a601a36c-360f-4988-bd05-a1d8ef123964"],
Cell[49838, 1252, 952, 26, 123, "Output",ExpressionUUID->"c5d778fb-508e-45f3-8d09-1ed072cba3fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50827, 1283, 2987, 77, 261, "Input",ExpressionUUID->"8e99c588-bfe3-47dc-91f7-9bca0d643a80"],
Cell[53817, 1362, 384, 7, 26, "Print",ExpressionUUID->"40c173ce-2cc9-4e85-a74b-742a6ed5eadc"],
Cell[54204, 1371, 1122, 26, 120, "Output",ExpressionUUID->"1e58ff74-77f9-49b1-817f-2f7111f251d5"],
Cell[55329, 1399, 387, 6, 61, "Output",ExpressionUUID->"9a7566e9-ccc9-496a-a317-9c93601bb02d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55753, 1410, 1213, 32, 130, "Input",ExpressionUUID->"b982cd8c-c61c-4f16-bd78-9e2638b20574"],
Cell[56969, 1444, 1076, 27, 123, "Output",ExpressionUUID->"5a331bee-e583-4cfd-a544-108ee37d71f5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58082, 1476, 1083, 30, 130, "Input",ExpressionUUID->"3773fa6f-aa1f-4021-a9bf-6ca8b0d100ab"],
Cell[59168, 1508, 1084, 28, 123, "Output",ExpressionUUID->"289fc8ee-3285-40e0-b76a-7bfa3ddef2fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60289, 1541, 1135, 31, 130, "Input",ExpressionUUID->"7057e4bf-e6f1-4efd-a651-f65b9568374b"],
Cell[61427, 1574, 1073, 27, 123, "Output",ExpressionUUID->"27396a1c-e746-4cc3-917a-3615c71d5226"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62537, 1606, 1084, 30, 130, "Input",ExpressionUUID->"d255a988-1fd1-4c4f-b86b-ba38ac86d726"],
Cell[63624, 1638, 1084, 28, 123, "Output",ExpressionUUID->"2fc6ecd8-6f38-4812-899f-a23d086f24b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64745, 1671, 3069, 78, 261, "Input",ExpressionUUID->"b1e117ac-2bb3-454f-9aef-96ff63cc6b04"],
Cell[67817, 1751, 286, 6, 26, "Print",ExpressionUUID->"94d28b83-7de9-405c-9054-d53a7cecc65e"],
Cell[68106, 1759, 1398, 32, 120, "Output",ExpressionUUID->"fe8ea866-c068-4d68-979f-fa1635da7dee"],
Cell[69507, 1793, 302, 6, 61, "Output",ExpressionUUID->"09e86859-3f3b-4bd8-be94-b9def9b35e08"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69846, 1804, 1217, 33, 145, "Input",ExpressionUUID->"9ca11734-96af-4cea-b7d9-3393e6c250a3"],
Cell[71066, 1839, 1163, 30, 123, "Output",ExpressionUUID->"cadc2088-dd2c-4bc5-8138-b86e3c4bc74e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72266, 1874, 1087, 31, 145, "Input",ExpressionUUID->"e0a4ee7a-ffb8-4851-9113-45cf557fc3d1"],
Cell[73356, 1907, 1938, 48, 123, "Output",ExpressionUUID->"a1dc4f44-5ef7-4ed6-8857-20a6f649f60a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75331, 1960, 1087, 31, 145, "Input",ExpressionUUID->"4041ef98-c99a-44b6-a41f-8384c64df965"],
Cell[76421, 1993, 1942, 48, 123, "Output",ExpressionUUID->"4e52a6fb-d34a-4610-b9e8-43ea5edaa61b"]
}, Open  ]]
}
]
*)

